<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>
<body>
<p>In questa tesi ci si pone l’obiettivo di fornire una soluzione al problema della segmentazione di macchie cutanee, i nei, per effettuare successivamente delle misure che possono riguardare lo stato dei bordi, la forma e le simmetrie.</p>
<p>Il problema della segmentazione risolto utilizzando un algoritmo basato su un nuovo modello di contorni attivi, <span><em>snakes</em></span> o <span><em>active contours</em></span>, in cui la funzione energia potenziale, o funzione costo, non legata alla definizione del bordo come gradiente di una immagine intensit, ma funzione della distanza fra le intensitinterna ed esterna alla curva chiusa che individua lo snake. Si realizza cosla fusione delle informazioni locali nell’intorno dello snake e quelle globali date dalla media delle intensitnelle due regioni individuate.</p>
<p>Per quanto riguarda il modello del contorno si considerata la sua rappresentazione a B-splines cubiche uniformi, la quale permette di mantenere la curva sufficientemente regolare con una sua descrizione sufficientemente compatta; infatti essa descritta interamente da un insieme limitato di parametri: i suoi <span><em>control points</em></span>. Per permettere alla curva di adattarsi alla complessitdell’oggetto da segmentare, che per sua natura non nota a priori, necessario rendere flessibile il numero dei control points; stato perciødefinito un metodo di ridistribuzione dei campioni della curva con l’ausilio di un reticolo, che rappresenta una scomposizione simpliciale (triangolazione) del piano immagine. L’associazione tra i nuovi campioni e i nuovi control points realizzata in base ad un opportuno criterio che misura la complessitlocale della curva nei punti campione individuati.</p>
<p>Per migliorare le prestazioni della segmentazione opportuno partire da un contorno iniziale prossimo a quello reale della macchia considerata, intendendo quindi tale procedimento come una fase di presegmentazione. Lo stato iniziale dello snake puøessere dato dal contorno della regione ottenuta a partire dalla binarizzazione della componente principale della <span><em>trasformata di Karhunen-Loève</em></span> (o di <span>Hotelling</span>) dell’immagine originale, successivamente elaborata con degli operatori morfologici in modo che risulti compatta.</p>
<p>Elaborando la componente principale con un operatore locale anisotropo, il cui comportamento in un punto dell’immagine dipende dalle caratteristiche dei punti in un opportuno intorno, possibile definire una procedura per ridurre l’effetto di disturbo di elementi come i peli.</p>
<h1 id="introduzione">Introduzione</h1>
<p>Uno dei problemi posti in dermatoscopia la misura delle caratteristiche delle macchie cutanee, per cui di interesse sviluppare degli strumenti che permettano di effettuare tali misure in modo automatico.</p>
<p>Le misure riguardano generalmente le dimensioni, lo stato del bordo, se piŏ meno frastagliato, e le simmetrie sia relativamente alla forma sia rispetto alla pigmentazione della superficie del neo.</p>
<p>Per poter effettuare tali misure necessario, per prima cosa, individuare la macchia, o neo, estraendola dal contesto determinato dalla pelle circostante, tenendo presente gli elementi di disturbo tipo i peli, le cui dimensioni non possono essere considerate sempre trascurabili relativamente a quelle del neo.</p>
<p>(5)</p>
<p>Due sono quindi gli obiettivi che ci si proposti di raggiungere: un problema di <span><em>segmentazione</em></span>: individuare il neo; rappresentazione semplice e compatta del suo contorno per facilitare le successive misure.</p>
<p>Per quanto riguarda la segmentazione esiste un’ampia scelta di metodi che si sviluppano a partire da due modi equivalenti di interpretare il problema. I primi definiscono la soluzione come la partizione dell’immagine in regioni uniformi, ovvero la partizione a cardinalitmassima ottenibile rispetto ad un dato criterio di uniformit, che nel nostro caso potrebbe essere il colore (in quanto il neo una regione con pigmentazione differente, generalmente piscura, rispetto alla pelle circostante). La seconda classe di metodi invece considera come obiettivo l’individuazione dei contorni che separano le diverse regioni.</p>
<p>Concettualmente le due tecniche sono equivalenti, in pratica, hanno un comportamento complementare: nel primo caso si ha una minor sensibilital rumore presente nell’intorno dei contorni mentre si ha difficilmente una rappresentazione compatta dei segmenti ottenuti; nel secondo caso invece si ha una maggior sensibilital rumore, ma al contrario si ha una maggior capacitdi localizzazione dei bordi la possibilitdi ottenere rappresentazioni compatte del contorno dei segmenti, in particolare con l’utilizzo di opportuni modelli di <span><em>contorni attivi</em></span> (<span><em>active contours</em></span> o <span><em>snakes</em></span>) che sono trattati in questa tesi.</p>
<p>Recentemente sono stati proposti inoltre degli algoritmi con combinano i due approcci (<span class="citation" data-cites="Duncan"></span>, <span class="citation" data-cites="Yuille"></span> e <span class="citation" data-cites="Yezzi"></span>) in modo da compensarne i difetti e sommarne i vantaggi. La prima soluzione <span class="citation" data-cites="Duncan"></span> prevede l’interazione dei due blocchi distinti attraverso una serie di regole che stabiliscono come i due interagiscono fino a raggiungere uno stato di equilibrio.</p>
<p>La seconda soluzione, che qui considerata, realizza l’obiettivo a partire dalla definizione di un nuovo modello di snakes in cui i contorni non sono direttamente caratterizzati come le zone ad alto gradiente, ma indirettamente attraverso una nuova funzione energia che tiene conto della statistica delle regioni separate dallo snake e che minima quando questi si dispone lungo il contorno dell’oggetto considerato. In particolare l’algoritmo proposto da Yezzi et al. in <span class="citation" data-cites="Yezzi"></span> presenta delle specifiche che lo rendono interessante per la semplicitdella definizione della funzione energia e per ciøche ne consegue in termini di implementazione.</p>
<p>L’algoritmo permette infatti di segmentare l’immagine nei suoi diversi elementi non appena sia fissata la primitiva, <span><em>feature</em></span>, rispetto alla quale risultano distinti; da notare che non necessario conoscere il valore della primitiva caratteristico di ciascun oggetto ma sufficiente sapere che per ciascuno differente. Un’altro vantaggio rilevante dato dal fatto che la definizione data permette di considerare non una sola feature alla volta, ma contemporaneamente un vettore di features che possono essere di natura diversa tra loro. Nel caso specifico permette di trattare le immagini a colori che sono matrici <span class="math"><em>R</em> × <em>C</em></span> di pixels a ciascuno dei quali associato un vettore di tre elementi, nel caso pisemplice le tre componenti <span class="math"><em>R</em><em>G</em><em>B</em></span>.</p>
<p>Accanto alla definizione della funzione energia occorre definire il modello che rappresenta fisicamente la curva chiusa e quindi lo snake: si scelta una rappresentazione a B-splines cubiche uniformi. La curva rappresentata perciøcome l’unione di tratti di cubica (<span><em>spans</em></span>) che sono combinati secondo dei parametri, i punti di controllo o <span><em>control points</em></span>; l’ordine del polinomio definisce il grado di regolaritdella curva.</p>
<p>In tal modo si ottenuta una rappresentazione compatta, come si voleva, interamente rappresentata dai punti di controllo, che sono in numero limitato, e rispetto ai quali possibile definire le misure delle caratteristiche geometriche del contorno.</p>
<p>Un problema associato alla scelta del metodo di segmentazione riguarda l’inizializzazione del contorno attivo: lo snake definito in <span class="citation" data-cites="Yezzi"></span> concettualmente abbastanza insensibile all’inizializzazione (in pratica vi possono essere dei limiti se l’immagine non considerabile bimodale) a differenza dei modelli di snake precedenti che si basano sulla ricerca degli edge nell’intorno della curva e per i quali opportuna una buona inizializzazione. In ogni caso opportuna per ridurre i tempi di esecuzione dell’algoritmo.</p>
<p>L’inizializzazione si puøintendere come una fase di presegmentazione ed data dal contorno della regione ricavata binarizzando la componenete principale della <span><em>trasformata di Karhunen-Loève</em></span> (o di <span><em>Hotelling</em></span>) dell’immagine originale, seguita da alcune elaborazioni con operatori morfologici per ottenere una regione compatta. Inizializzando la curva in prossimitdel bordo della macchia possibile realizzare un’implementazione locale dell’algoritmo di Yezzi che permette di ridurre le due regioni interna ed esterna a due fascie definite nell’intorno dello snake. In tal modo si ha che le due aree possono essere approssimativamente uguali, indipendentemente dalle dimensioni della macchia rispetto al piano immagine, ed inoltre possibile escludere le zone prossime ai bordi del sensore, maggiormente sensibili ai disturbi dovuti alla illuminazione non uniforme e agli stessi effetti di bordo dell’ottica.</p>
<p>In questa fase possibile inoltre ridurre gli elementi di disturbo come i peli: sfruttando il fatto che questi hanno una elevata correlazione lungo una direzione, che comunque incognita, possibile realizzare un operatore locale che elabora l’immagine in funzione della misura di anisotropia rilevata nell’intorno del punto considerato. Esistono diverse definizioni per tale misura, nel nostro caso si considerata una funzione della media dei valori dell’intensitdella stessa componente principale lungo direzioni prefissate; quindi in corrispondenza dei punti che si considerano appartenenti al pelo, per cui la misura superiore ad un valore di soglia, si sostituisce il valore dell’intensitcon un nuovo valore che dipende dai pixels circostanti che molto probabilmente appartengono alla cute o al neo.</p>
<p>A partire dalla curva iniziale, definita da un certo numero di control points distribuiti nel piano, necessario permettere che questa possa adattarsi alla complessitdell’oggetto che rileva durante la sua evoluzione. Si pensato quindi di realizzare una riparametrizzazione della curva, basata su un metodo di <span><em>triangolazione</em></span> (o <span><em>scomposizione simpliciale</em></span>), e la definizione di un criterio di complessitper determinare un nuovo numero di punti di controllo.</p>
<p>[<em>Capitolo 2.] Sono descritti alcuni operatori per l’elaborazione digitale delle immagini: [<em>Capitolo 3.] Introduzione al problema della segmentazione e descrizione di alcuni algoritmi di binarizzazione. [<em>Capitolo 4.] Definizione e proprietdelle B-splines. [<em>Capitolo 5.] I modelli dei contorni attivi: l’approccio statistico proposto da Yezzi et al. <span class="citation" data-cites="Yezzi"></span>. [<em>Capitolo 6.] Descrizione dell’architettura dell’algoritmo proposto con alcuni risultati. </em></em></em></em></em></p>
<h1 id="operatori-per-lelaborazione-digitale-delle-immagini">Operatori per l’elaborazione digitale delle immagini</h1>
<h2 id="cambiamento-di-risoluzione">Cambiamento di risoluzione</h2>
<p>Le immagini analogiche generate da un sistema ottico per poter essere memorizzate ed elaborate vengono campionate nelle coordinate spaziali e quantizzate nell’intensit. La suddivisione dell’immagine in <span class="math"><em>M</em></span> righe e <span class="math"><em>N</em></span> colonne individua un numero finito <span class="math"><em>M</em> ⋅ <em>N</em></span> di elementi d’immagine (<span><em>pixel</em></span>); <span class="math"><em>M</em></span> ed <span class="math"><em>N</em></span> specificano quindi la risoluzione dell’immagine. In alcuni casi un’alta definizione puørisultare non indispensabile e anzi costituire un limite all’efficienza dell’algoritmo in quanto si ha un elevata quantitdi dati da analizzare. Inoltre vi sono applicazioni in cui si sfrutta la possibilitdi analizzare l’immagine a diverse scale di definizione per poter individuare alcune strutture dell’imma-gine che risultano invarianti al variare della risoluzione. In particolare con l’adozione di opportune strutture dati come la piramide di immagini (<span class="citation" data-cites="Zamperoni"></span>, <span class="citation" data-cites="Meer"></span>).</p>
<h3 id="riduzione-della-risoluzione">Riduzione della risoluzione</h3>
<p>La trasformazione che porta alla riduzione della risoluzione mappa necessariamente diversi punti dell’immagine ad alta risoluzione in un punto di quella a risoluzione inferiore. Il caso pisemplice dato dal campionamento in cui si considerano, ad esempio, i punti dell’immagine ad indici dispari:</p>
<p>(5)</p>
<p>sia <span class="math"><em>f</em> ( <em>x</em> ,  <em>y</em> )</span> l’immagine di partenza di dimensioni <span class="math">( <em>R</em>, <em>C</em> )</span>, con <span class="math"><em>R</em></span> e <span class="math"><em>C</em></span> pari, allora h(x,y)=f(2x-1,2y-1)</p>
<p>con le due dimensione ridotta di un fattore <span class="math">2</span>.</p>
<p>(5)</p>
<p>A causa della riduzione della risoluzione si puøavere una perdita nella definizione di alcuni dettagli dell’immagine; tale perdita di informazione che puøessere limitata con un’opportuna scelta del nucleo della trasformazione stessa, per esempio considerando la media del valore dei pixel nell’intorno del punto considerato: h(x,y) &amp; = &amp; [f(2x-1,2y-1)+ f(2x-1,2y)+<br />&amp; &amp; +f(2x,2y-1)+ f(2x,2y-1)]</p>
<p>Per un maggior approfondimento sulla scelta del nucleo si puøfar riferimento a quanto riportato in <span class="citation" data-cites="Meer"></span>.</p>
<h2 id="trasformazioni-dello-spazio-dei-colori">Trasformazioni dello spazio dei colori</h2>
<p>Generalmente le immagini a colori sono rappresentate per mezzo del modello <span class="math"><em>R</em><em>G</em><em>B</em></span>, dove ad ogni pixel associato un vettore tridimensionale le cui componenti sono proprio i valori di rosso <span class="math"><em>R</em></span>, verde <span class="math"><em>G</em></span> e blu <span class="math"><em>B</em></span> in cui possibile scomporre il colore percepito del pixel.</p>
<p>Una rappresentazione di questo tipo perølegata alle caratteristiche del sensore (CCD) che ha fornito l’immagine per cui spesso si ricorre ad altri spazi in cui rappresentare le proprietintrinseche del colore meno sensibili alle caratteristiche del sensore stesso.</p>
<p>Esiste una vasta gamma di possibili modelli, trasformazioni, metriche che possono essere utilizzate per evidenziare le proprietutili alle diverse applicazioni <span class="citation" data-cites="Wyszecki"></span>; nel nostro caso si sono considerate la trasformazione che permette di ottenere le componenti <span class="math"><em>H</em><em>S</em><em>I</em></span> del colore e la <span><em>trasformazione di Karhunen-Loève</em></span>.</p>
<h3 id="lo-spazio-hsi">Lo spazio HSI</h3>
<p>La trasformazione che mappa lo spazio <span class="math"><em>R</em><em>G</em><em>B</em></span> nello spazio <span class="math"><em>H</em><em>S</em><em>I</em></span> (o <span class="math"><em>H</em><em>S</em><em>V</em></span>) non lineare con alcune singolarit:</p>
<p>(<span><em>Hue</em></span>) <span><em>Tonalit</em></span>: caratterizza il colore dominante nel punto <span><strong>x</strong></span> del-l’immagine. Una possibile rappresentazione dello spazio della coordinata puøessere quello di figura.</p>
<p></p>
<p>E’ puøessere definita formalmente H=((G-B),2R-G-B)</p>
<p>che vale <span class="math">0</span> in presenza della sola componente monocromatica <span class="math"><em>R</em></span>.</p>
<p>(<span><em>Intensity</em></span>) <span><em>Luminosit</em></span>: I=</p>
<p>vale <span class="math">0</span> nel caso del colore nero ed massima per il bianco.</p>
<p>(<span><em>Saturation</em></span>) <span><em>Saturazione</em></span> o <span><em>Purezza</em></span>: misura il rapporto fra la componente monocromatica dominante e quella bianca necessarie ad ottenere il colore del punto. S=1-3 <span class="math"><em>S</em>  =  1</span> denota un colore puro, mentre vale <span class="math"><em>S</em>  =  0</span> se bianco (<span class="math"><em>R</em>  =  <em>G</em>  =  <em>B</em>  =  1</span>).</p>
<p>Alternativamente alla componente <span class="math"><em>I</em></span> si puøtrovare la componente <span class="math"><em>V</em></span> definita</p>
<p>: V={R,G,B}</p>
<h3 id="trasformata-di-karhunen-loève-o-di-hotelling">Trasformata di Karhunen-Loève o di Hotelling</h3>
<p>La <span><em>trasformata di Karhunen-Loève o di Hotelling</em></span>, con le sue varianti, la trasformazione che permette di ottenere i migliori risultati nei problemi di segmentazione <span class="citation" data-cites="Lee"></span>, <span class="citation" data-cites="Schmid"></span> e di analisi della tessitura (<span><em>texture</em></span>) <span class="citation" data-cites="Wouver"></span> rispetto ai diversi modelli di colore. L’effetto della <span><em>trasformata di Hotelling</em></span> sui vettori di un dato spazio quello di proiettarli in un nuovo spazio con le stesse dimensioni dove perøora le componenti risultano statisticamente scorrelate.</p>
<p>(10)</p>
<p>Di seguito consideriamo la definizione della trasformazione applicata al caso di immagini a colori definite nello spazio <span class="math"><em>R</em><em>G</em><em>B</em></span>:</p>
<p>(5)</p>
<p>dati i pixels <span class="math">${\bf x}$</span> dell’immagine <span class="math"><em>I</em></span>, si considerano il vettore media e la matrice di covarianza</p>
<p>=E[<span><strong>x</strong></span>] =E[(<span><strong>x</strong></span>-<span><strong>m</strong></span>)(<span><strong>x</strong></span>-<span><strong>m</strong></span>)<sup>T</sup>]</p>
<p>In pratica si sostituiscono con le rispettive media e covarianza campionaria.</p>
<p>Si procede calcolando gli autovalori <span class="math"><em>λ</em><sub><em>i</em></sub></span> e gli autovettori <span class="math">${\bf e}_i$</span> della matrice di covarianza <span class="math">${\bf k}$</span>; quindi si costruisce la matrice <span class="math">${\bf A}$</span> le cui righe sono gli autovettori ordinati secondo autovalori decrescenti. La <span><em>trasformazione di Hotelling</em></span> ottenuta semplicemente =<span><strong>A</strong></span>(<span><strong>x</strong></span>-<span><strong>m</strong></span>)</p>
<p>Per verificare che le componenti degli <span class="math">${\bf y}$</span> sono incorrelate si consideri la matrice di covarianza che in questo caso anche di correlazione in quanto sono vettori a media nulla, infatti =E[<span><strong>y</strong></span>]=<span><strong>A</strong></span>(E[<span><strong>x</strong></span>]-<span><strong>m</strong></span>)=<span><strong>0</strong></span> =E[(<span><strong>y</strong></span>-<span><strong>m<sub>y</sub></strong></span>)(<span><strong>y</strong></span>-<span><strong>m<sub>y</sub></strong></span>)<sup>T</sup>] =<span><strong>A</strong></span><span><strong>k</strong></span><span><strong>A</strong></span><sup>T</sup></p>
<p>Tenendo presente che la matrice di covarianza <span class="math">${\bf k}$</span> simmetrica, allora esiste una matrice ortogonale, le cui righe formano una base ortonormale dello spazio <span class="math"><em>R</em><em>G</em><em>B</em></span>, che la diagonalizza. La matrice ortogonale proprio <span class="math">${\bf A}$</span>, le cui righe sono gli autovettori di <span class="math">${\bf k}$</span>, per cui la matrice diagonale risultante <span class="math">${\bf k_y}$</span>; ciøsignifica che le componenti di <span class="math">${\bf y}$</span> sono statisticamente scorrelate e con varianza data dagli autovalori, elementi della diagonale della matrice di covarianza.</p>
<p>(5)</p>
<p>Dallo sviluppo della <span><em>trasformata di Hotelling</em></span> si osserva che essa permette di scomporre l’immagine secondo le sue componenti principali valutate lungo le direzioni a massima varianza. Questo permette sia di limitare le trasformazioni successive alle componenti di maggior rilievo, con un risparmio computazionale, sia di migliorare la qualitdelle trasformazioni successive in quanto possibile scartare le componenti caratterizzate da una minor varianza (autovalori minori) che sono pisensibili al rumore (minore <span class="math"><em>S</em><em>N</em><em>R</em></span>).</p>
<p>A partire dai vettori trasformati <span class="math">${\bf y}$</span> possibile riottenere i vettori dello spazio originario <span class="math">${\bf x}$</span> applicando la trasformazione inversa</p>
<p>=<span><strong>A</strong></span><sup>-1</sup><span><strong>y</strong></span>+<span><strong>m</strong></span></p>
<p>con <span class="math">${\bf A}^{-1}\,=\,{\bf A}^T$</span> per l’ortogonalit.</p>
<p>Se ora si considerano solo i primi <span class="math"><em>n</em></span> autovettori e le prime <span class="math"><em>n</em></span> componenti di <span class="math">${\bf y}$</span>, si ricava</p>
<p>=<span><strong>A</strong></span><sup>T</sup><sub>n</sub><span><strong>y</strong></span><sub>n</sub>+<span><strong>m</strong></span></p>
<p>che rappresenta una approssimazione di <span class="math">${\bf x}$</span>.</p>
<p>Rilevante il fatto che possibile stabilire l’errore di approssimazione, ovvero la sua potenza statistica, in modo immediato data l’ortogonalitdelle componenti. Se <span class="math"><em>N</em></span> il numero totale degli autovalori la potenza dell’errore di stima</p>
<p>P<sub>e</sub>=<sub>i=n+1</sub><sup>N</sup><sub>i</sub></p>
<p>Tenendo quindi presente che gli autovalori sono ordinati in modo decrescente tale errore risulta minimo fissato <span class="math"><em>n</em></span>.</p>
<p>La trasformata di Karhunen-Loève dipende, attraverso gli autovettori della matrice di covarianza, dalle caratteristiche dell’immagine in esame; si verificato perø<span class="citation" data-cites="Ohta"></span> che tali autovettori rimangono pressochinvariati per un vasto insieme di immagini di sogetti reali.</p>
<p>Quindi la trasformata si puøsemplificare nella forma</p>
<p>=</p>
<p>Si osservi che la prima componente definita come l’<span><em>Intensit</em></span> in <span class="math"><em>H</em><em>S</em><em>I</em></span>.</p>
<h2 id="operatori-morfologici">Operatori Morfologici</h2>
<p>Sono una classe importante di operatori locali che operano sulla forma degli elementi che compaiono nell’immagine. Gli operatori morfologici vengono utilizzati per eliminare piccoli oggetti, fessure, buchi, regolarizzare i bordi e per individuare i bordi (<span><em>edge-detection</em></span>); oppure per estrarre degli oggetti noti da un’immagine (<span><em>shape analysis &amp; pattern classification</em></span>).</p>
<p>La teoria alla base di tali trasformazioni, da cui mutuano il nome, la <span><em>matematica morfologica</em></span> che si sviluppa a partire dalla teoria degli insiemi che assumono, in tale contesto, un significato particolare. In questo paragrafo si propone una breve introduzione ai due operatori base, <span><em>dilatazione</em></span> (<span><em>dilation</em></span>) ed <span><em>erosione</em></span> (<span><em>erosion</em></span>), e le due trasformazioni fondamentali, ottenute dalle precedenti, <span><em>apertura</em></span> (<span><em>opening</em></span>) e <span><em>chiusura</em></span> (<span><em>closing</em></span>). Per un maggior approfondimento si rimanda ai riferimenti <span class="citation" data-cites="Haralick87"></span>,<span class="citation" data-cites="Haralick92"></span> dello stesso autore in cui si possono trovare, oltre alle dimostrazioni, maggiori argomentazioni sull’importanza di tali operatori e diverse indicazioni sulle possibili applicazioni.</p>
<p>(5)</p>
<p>Di seguito si considerano le definizioni dei diversi operatori e le loro principali proprietin particolare in relazione alla loro implementazione.</p>
<h3 id="dilatazione-ed-erosione">Dilatazione ed Erosione</h3>
<p>Siano <span class="math"><em>A</em></span> e <span class="math"><em>K</em></span> due sottoinsiemi di <span class="math">$\M(E)^N$</span>, si definisce <span><strong>dilatazione</strong></span> di <span class="math"><em>A</em></span> data <span class="math"><em>K</em></span> AK={c(E)<sup>N</sup>:c=a+k,aA,kK}</p>
<p>si definisce <span><strong>erosione</strong></span> di <span class="math"><em>A</em></span> dato <span class="math"><em>K</em></span> AK={c(E)<sup>N</sup>:c+kA,kK}</p>
<p>In generale i termini <span class="math"><em>A</em></span> e <span class="math"><em>K</em></span> sono due generici sottoinsiemi dello spazio <span class="math">$\M(E)^N$</span>, in realtil primo operando l’immagine che si sta elaborando mentre il secondo costituisce il nucleo o elemento strutturale (<span><em>structuring element</em></span>) della trasformazione rappresentante un parametro di forma di un elemento dell’immagine.</p>
<p>Per implementare in modo piĕfficiente i due operatori opportuno esprimerli come combinazioni dell’immagine traslata</p>
<p>Dati <span class="math">$A\,\subseteq\,\M(E)^N$</span>, <span class="math">$x\,\in\,\M(E)^N$</span>, si definisce traslazione di <span class="math"><em>A</em></span> dato <span class="math"><em>x</em></span> A<sub>x</sub>={c(E)<sup>N</sup>:c=a+x,aA}</p>
<p>AK=<sub>k K</sub>A<sub>k</sub></p>
<p>AK=<sub>k K</sub>A<sub>-k</sub></p>
<p>Gli operatori di <span><em>dilatazione</em></span> ed <span><em>erosione</em></span> soddisfano le seguenti propriet:</p>
<p>. Vale solo per l’operatore di <span><em>dilatazione</em></span>. AK=KA</p>
<p>. Sia <span class="math"><em>K</em>  =  <em>K</em><sub>1</sub>  ⊕  <em>K</em><sub>2</sub></span> AK &amp; = &amp; A(K<sub>1</sub>K<sub>2</sub>)=(AK<sub>1</sub>)K<sub>2</sub><br />AK &amp; = &amp; A(K<sub>1</sub>K<sub>2</sub>)=(AK<sub>1</sub>)K<sub>2</sub></p>
<p>.</p>
<p>Fra le possibili combinazioni si considerano in particolare A(BC) &amp; = &amp; (AC)(AC)<br />A(BC) &amp; = &amp; (AC)(AC)</p>
<p>Dalle ([assde]) e ([dist]) si possono ricavare due soluzioni per scomporre il nucleo della tarsformazione (<span><em>structuring element</em></span>); la differenza che nelle () si ottiene una cascata di operazioni elementari mentre nelle () tali operazioni sono eseguibili in parallelo.</p>
<p>Esiste anche un teorema di dualitche lega i due operatori.</p>
<p><br /><span class="math">( <em>A</em>  ⊖  <em>B</em> )<sup><em>c</em></sup>  =  <em>A</em><sup><em>c</em></sup>  ⊕  <em>B̌</em></span><br /></p>
<p>dove <span class="math"><em>B̌</em>  =  { <em>x</em> :  ∃  <em>b</em>  ∈  <em>B</em> :  <em>x</em>  =   −  <em>b</em> }</span></p>
<p>e <span class="math">( <sup><em>c</em></sup> )</span> l’usuale operazione di complemento rispetto l’insieme <span class="math">$\M(E)^N$</span>.</p>
<p>Il teorema mette in luce il fatto che le due operazioni non sono l’una l’inversa dell’altra nel senso usuale del termine, ma si possono considerare complementari. Nel senso che se si considera la dilatazione di un insieme <span class="math">$A\,\subseteq\,\M(E)^N$</span>, possibile in modo duale ottenere lo stesso risultato con un’operazione di erosione sull’insieme complementare. In particolare nel caso in cui il nucleo (<span><em>structuring element</em></span>) sia simmetrico, per cui <span class="math"><em>Ǩ</em>  =  <em>K</em></span>, si ha che l’erosione di <span class="math"><em>A</em></span> dato <span class="math"><em>K</em></span> perfettamente complementare alla dilatazione di <span class="math"><em>A</em><sup><em>c</em></sup></span> dato <span class="math"><em>K</em></span>.</p>
<p>(5)</p>
<p>Prima di introdurre i due operatori fondamentali della matematica morfologica opportuno considerare il seguente risultato</p>
<p><br /><span class="math"><em>A</em>  ⊕  ( <em>B</em>  ⊖  <em>C</em> )  ⊆  ( <em>A</em>  ⊕  <em>B</em> )  ⊖  <em>C</em></span><br /></p>
<p>che evidenzia l’importanza dell’ordine di applicazione dei due operatori <span><em>dilatazione</em></span> ed <span><em>erosione</em></span>.</p>
<h3 id="apertura-e-chiusura">Apertura e Chiusura</h3>
<p>In pratica le due operazioni considerate nella sezione precedente non sono quasi mai utilizzate singolarmente ma combinate per realizzare le due trasformazioni fondamentali di <span><em>apertura</em></span> (<span><em>opening</em></span>) e <span><em>chiusura</em></span> (<span><em>closing</em></span>).</p>
<p>Si definisce <span><strong>apertura</strong></span> di <span class="math"><em>A</em></span> dato <span class="math"><em>K</em></span></p>
<p>AK=(AK)K.</p>
<p>Se <span class="math"><em>A</em>  ∘  <em>K</em>  =  <em>A</em></span> si dice che <span class="math"><em>A</em></span> rispetto <span class="math"><em>K</em></span>.</p>
<p>Si definisce <span><strong>chiusura</strong></span> di <span class="math"><em>A</em></span> dato <span class="math"><em>K</em></span></p>
<p>AK=(AK)K.</p>
<p>Se <span class="math"><em>A</em>  •  <em>K</em>  =  <em>A</em></span> si dice che <span class="math"><em>A</em></span> chiuso rispetto <span class="math"><em>K</em></span>.</p>
<p>Una proprietimportante dei due operatori l’idempotenza.</p>
<p>(AK)K &amp; = &amp; AK<br />(AK)K &amp; = &amp; AK</p>
<p>Vale anche una relazione di dualitda intendersi come per i due operatori precedenti.</p>
<p>(AK)<sup>c</sup>=A<sup>c</sup></p>
<p>Un’interpretazione geometrica dell’azione dei due operatori data dal seguente risultato.</p>
<p>AK={xA:y:xK<sub>y</sub>A} =<sub>{y:K<sub>y</sub>A}</sub>K<sub>y</sub></p>
<p>Esprime l’operazione di <span><em>apertura</em></span> come l’unione di tutte le possibili traslazioni di <span class="math"><em>K</em></span> che sono contenute in <span class="math"><em>A</em></span>.</p>
<p>Sfruttando la dualitsi ha invece che l’operazione di <span><em>chiusura</em></span> otenuta come il complemento dell’unione di tutte le traslazioni di <span class="math"><em>Ǩ</em></span> contenute in <span class="math"><em>A</em><sup><em>c</em></sup></span>.</p>
<h3 id="operatori-morfologici-per-immagini-binarie">Operatori morfologici per immagini binarie</h3>
<p>Nel caso particolare di immagini binarie gli operatori morfologici si riducono ad espressioni logiche a cui possibile applicare le regole dell’algebra di Boole.</p>
<p>Si consideri l’operazione di <span><em>dilatazione</em></span> espressa nella forma () con <span class="math"><em>A</em></span>, il sottoinsieme che definisce gli oggetti presenti e i cui pixels assumono valore <span class="math">1</span> (<span><em>foreground</em></span>), e <span class="math"><em>K</em></span> che assume valori in <span class="math">{0, 1}</span>; allora</p>
<p><br /><span class="math"><em>A</em>  ⊕  <em>K</em>  =  ⋃ <sub><em>k</em>  ∈  <em>K</em></sub> <em>A</em><sub><em>k</em></sub>  =  ⋃ <sub><em>a</em>  ∈  <em>A</em></sub> <em>K</em><sub><em>a</em></sub></span><br /></p>
<p>dove nell’ultimo passagio si sfruttata la commutativitdell’operatore ().</p>
<p>La <span><em>dilatazione</em></span> quindi ottenuta centrando la maschera <span class="math"><em>K</em></span> su tutti i pixel di <span class="math"><em>A</em></span> e commutando ad <span class="math">1</span> tutti i pixels vicini che assumono eventualmente il valore <span class="math">0</span> appartenenti a <span class="math"><em>A</em><sup><em>c</em></sup></span> (<span><em>background</em></span>).</p>
<p>Tale operazione puøessere realizzata considerando gli operatori logici <span class="math"><em>a</em><em>n</em><em>d</em>  ∧ </span> e <span class="math"><em>o</em><em>r</em>  ∨ </span> tra l’immagine <span class="math"><em>I</em>  ⊇  <em>A</em></span> e la maschera <span class="math"><em>K</em></span>. Nell’ipotesi verosimile che quest’ultima sia definita da una finestra-matrice simmetrica di dimensioni <span class="math">( 2 <em>n</em>  +  1, 2 <em>n</em>  +  1 )</span> si ricava</p>
<p>(r,c)=<sub>i=-n</sub><sup>n</sup><sub>j=-n</sub><sup>n</sup> K(i,j)I(r-i,c-j)</p>
<p>A questo punto possibile ottenere un’espressione anche per l’<span><em>erosione</em></span> sfruttando la dualite tenedo conto che <span class="math"><em>K</em></span> simmetrica per cui <span class="math"><em>Ǩ</em>  =  <em>K</em></span> e che il complemento dato dalla negazione</p>
<p>(r,c)=</p>
<p>Definiti questi due operatori possibile ottenere per composizione anche quelli picomplessi.</p>
<h3 id="operatori-morfologici-per-immagini-in-scala-di-grigio">Operatori morfologici per immagini in scala di grigio</h3>
<p>Anche in questo caso le espressioni viste in generale assumono una forma pisemplice una volta che si stabilito di lavorare con immagini a toni di grigio. Lo spazio considerato <span class="math">$\M(E)^N\,=\,\M(E)^3$</span> dove le prime due componenti di ciascun vettore sono le coordinate del punto dell’immagine mentre la terza rappresenta il valore dell’intensitdell’immagine nel punto.</p>
<p>Per le immagini in scala di grigio le due operazioni che permettono di definire la <span><em>dilatazione</em></span> e l’<span><em>erosione</em></span> sono quelle di <span><em>massimo</em></span> e <span><em>minmo</em></span> rispettivamente</p>
<p>Siano <span class="math">$F,K\,\subseteq\,\M(E)^2$</span>, <span class="math">$f\,:\,F\,\rightarrow\,\M(E)$</span> e <span class="math">$k\,:\,K\,\rightarrow\,\M(E)$</span></p>
<p>(fk)(x) &amp; = &amp; <sub></sub> {f(x-y)+k(y)}<br />(fk)(x) &amp; = &amp; <sub>{yK}</sub> {f(x+y)-k(y)}</p>
<p>Da cui possibile ottenere tutti gli altri operatori applicando le definizioni date precedentemente.</p>
<h2 id="rank-order-filters---mediana">Rank-order filters - Mediana</h2>
<p>Rappresentano una classe di operatori locali non lineari che dipendono dal-l’ordinamento dei valori definiti in una finestra <span class="math"><em>K</em> ( <em>n</em>, <em>n</em> )</span>, con <span class="math"><em>n</em></span> dispari, centrata su ogni pixel dell’immagine <span class="math"><em>I</em> ( <em>R</em>, <em>C</em> )</span>.</p>
<p>A partire da <span class="math">${\bf v}_K$</span>, vettore ordinato con valori crescenti, si possono ottenere <span class="math"><em>n</em><sup>2</sup></span> possibili risultati associati ai <span class="math">${\bf v}_K\,(i)$</span>, con <span class="math"><em>i</em></span> ordine del filtro, assegnabili al pixel centrale, oggetto dell’elaborazione.</p>
<p>Se <span class="math"><em>i</em> = 1</span> si ha il <span class="math"><em>m</em><em>i</em><em>n</em></span>, con <span class="math"><em>i</em> = <em>n</em><sup>2</sup></span> il <span class="math"><em>m</em><em>a</em><em>x</em></span> e con <span class="math"><em>i</em> = (<em>n</em><sup>2</sup> + 1) / 2</span> la <span class="math"><em>m</em><em>e</em><em>d</em><em>i</em><em>a</em><em>n</em><em>a</em></span> del vettore, che presenta alcune proprietinteressanti <span class="citation" data-cites="Zamperoni"></span> e <span class="citation" data-cites="Haralick92"></span>.</p>
<p>Nella costruzione del vettore <span class="math">${\bf v}_K$</span> si considerato anche il pixel centrale della finestra mentre in letteratura si possono trovare anche altre formulazioni che lo escludono. In questi casi bisogna fare attenzione che se <span class="math"><em>n</em></span> dispari allora <span class="math"><em>n</em><sup>2</sup> − 1</span>, il numero di elementi del nuovo vettore <span class="math">${\bf v}_K^\prime$</span>, pari e si hanno due possibili valori di mediana per <span class="math"><em>i</em> = (<em>n</em><sup>2</sup> − 1) / 2</span> e <span class="math"><em>i</em> = (<em>n</em><sup>2</sup> − 1) / 2 + 1</span>.</p>
<p>I <span><em>rank-order filters</em></span> in generale e l’<span><em>operatore mediana</em></span> in particolare, con le loro varianti, vengono utilizzati sia per ridurre il rumore presente nell’immagi-ne (<span><em>image enhancement</em></span>) sia come componente per l’estrazione di particolari caratteristiche (<span><em>features</em></span>) dell’immagine, quali pattern lineari.</p>
<h2 id="misura-dellanisotropia-locale">Misura dell’anisotropia locale</h2>
<p>Bisogna considerare che all’interno di immagini, soprattutto quelle naturali, vi sono particolari con caratteristiche spesso molto diverse tra di loro.</p>
<p>La possibilitdi adattare l’operatore alle proprietlocali dell’immagine permette di soddisfare delle condizioni che potrebbero risultare altrimenti incompatibili, come ridurre il rumore e contemporaneamente conservare o migliorare la definizione dei bordi (<span><em>edge sharpness</em></span>) e dei dettagli.</p>
<p>Bisogna a questo punto definire uno o piparametri che caratterizzino il comportamento del filtro nei diversi punti dell’immagine. Ciøviene realizzato attraverso una <span><em>misura di anisotropia</em></span> che rivela la proprietdi interesse come, ad esempio, i punti appartenenti ai bordi (si veda il caso della <span><em>diffusione anisotropa</em></span> ottenuta variando la forma del filtro gaussiano, che per sua natura isotropo, in funzione del gradiente dell’immagine <span class="citation" data-cites="Perona"></span>, <span class="citation" data-cites="Fischl"></span>).</p>
<p>(5)</p>
<p>Una semplice definizione di anisotropia data dalla funzione <span class="math"><em>α</em>(<em>p</em>)</span>, misura di anisotropia nel punto <span class="math"><em>p</em></span>, che stabilisce se il punto <span class="math"><em>p</em></span> appartiene ad una regione uniforme, <span class="math"><em>α</em>(<em>p</em>) = 0</span>, o a una retta (pattern lineare filiforme e ben definito rispetto allo sfondo), <span class="math"><em>α</em>(<em>p</em>) = 1</span>.</p>
<p>Definita una finestra <span class="math"><em>K</em>( <em>n</em>, <em>n</em> )</span>, con <span class="math"><em>n</em></span> dispari, centrata sul pixel <span class="math"><em>p</em></span>, possibile individuare <span class="math"><em>T</em> = 2 (<em>n</em> − 1)</span> <span><strong>digital straight line segments</strong></span> passanti per il punto <span class="math"><em>p</em></span> e che connettono due punti del bordo della finestra <span class="math"><em>K</em></span> come in figura (). Si consideri <span class="math"><em>M</em><sub><em>t</em></sub></span>, con <span class="math"><em>t</em> = 1, …, <em>T</em></span>, la media dell’intensit<span class="math"><em>I</em>(<em>x</em>, <em>y</em>)</span> lungo il segmento <span class="math"><em>t</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>o</em></span> moltiplicato per <span class="math"><em>n</em></span> M<sub>t</sub>=<sub>i=-z</sub><sup>z</sup>I(x+dx(t,i),y+dy(t,i)), z=(n-1)/2</p>
<p>dove <span class="math"><em>d</em><em>x</em>(<em>t</em>, <em>i</em>)</span> e <span class="math"><em>d</em><em>y</em>(<em>t</em>, <em>i</em>)</span> contengono gli spostamenti relativi tra il punto <span class="math"><em>p</em>(<em>x</em>, <em>y</em>)</span> su cui centrata la finestra e i punti appartenenti alla retta <span class="math"><em>t</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>a</em></span>.</p>
<p>Si definiscono ora <span class="math"><em>m</em><sub><em>K</em></sub>(<em>p</em>)</span> e <span class="math"><em>M</em><sub><em>K</em></sub>(<em>p</em>)</span> (2) m<sub>K</sub>(p)={M<sub>t</sub>} &amp; M<sub>K</sub>(p)={M<sub>t</sub>}</p>
<p>A questo punto possibile definire la misura <span class="math"><em>α</em>(<em>p</em>)</span> dell’anisotropia locale <br /><span class="math">$$\alpha(p)=\cases{0 &amp; se $M_K(p)=0$ \cr
                 {\displaystyle\frac{M_K(p)-m_K(p)}{M_K(p)+m_K(p)}} &amp; altrimenti. \cr}
\lb{lam}$$</span><br /></p>
<p></p>
<p></p>
<h1 id="segmentazione">Segmentazione</h1>
<p>Il processo di segmentazione ha come risultato finale la ripartizione dell’im-magine in unitmorfologiche, segmenti, disgiunte fra loro. Questo puøessere ottenuto determinando i bordi di tali segmenti oppure raggruppando i pixels (unitelementari) in regioni omogenee rispetto ad una particolare propriet(<span><em>feature</em></span>) fissata che puøessere il colore e/o la tessitura (<span><em>texture</em></span>).</p>
<h2 id="caratterizzazione-della-segmentazione">Caratterizzazione della segmentazione</h2>
<p>Formalmente la segmentazione puøessere definita Dati l’insieme <span class="math"><em>I</em></span>, che definisce nel nostro caso l’immagine da analizzare, e il predicato di omogeneit<span class="math">$\cal O$</span>, la segmentazione di <span class="math"><em>I</em></span> dato <span class="math">$\cal O$</span> una partizione <span class="math">$\cal P$</span> di <span class="math"><em>I</em></span> in <span class="math"><em>N</em></span> sottoinsiemi, o regioni, <span class="math"><em>R</em><sub><em>i</em></sub></span> tali che <span class="math">⋃ <sub><em>i</em> = 1</sub><sup><em>N</em></sup> <em>R</em><sub><em>i</em></sub>  =  <em>I</em>  <em>R</em><sub><em>i</em></sub>  ∩  <em>R</em><sub><em>j</em></sub>  =  ∅ ∀  <em>i</em>  ≠  <em>j</em></span></p>
<p><span class="math">${\cal O}(R_i)\,=\,true \quad \forall\,i$</span></p>
<p><span class="math">${\cal O}(R_i\,\cup\,R_j)\,=\,false \quad \forall\,R_i,R_j \quad adiacenti$</span></p>
<p>La prima propria della definizione di partizione; piĭnteressanti le altre due che stabiliscono che ciascuna regione omogenena rispetto <span class="math">$\cal O$</span> e soprattutto che a conclusione della segmentazione le regioni adiacenti devono necessariamente essere diverse tra loro, al contrario sarebbe possibile unirle con una ulteriore semplificazione della rappresentazione della stessa immagine <span class="math"><em>I</em></span>.</p>
<h2 id="tecniche-di-segmentazione">Tecniche di segmentazione</h2>
<p>Seguendo la classificazione data in <span class="citation" data-cites="Lucchese"></span> le tecniche di segmentazione possono essere suddivise nel seguente modo Tecniche definite sullo spazio delle primitive (<span><em>features</em></span>).</p>
<p>(<span><em>Feature-Space Based Techniques</em></span>) Clustering &amp; Adaptive k-means Clustering Histogram Thresholding Tecniche definite sull’intera morfologia dell’immagine.</p>
<p>(<span><em>Image-Domain Based Techniques</em></span>) Split &amp; Merge Region Growing Edge Based Neural-Network Based Classification Tecniche che tengono conto della fisica dell’interazione tra la luce e le superfici dei materiali.</p>
<p>(<span><em>Physics Based Techniques</em></span>)</p>
<p>Anche se la classificazione in <span class="citation" data-cites="Lucchese"></span> definita in relazione alle tecniche che considerano l’informazione ricavata dal solo <span><em>colore</em></span> delle superfici, possibile estenderla anche al caso in cui si consideri la tessitura (<span><em>texture segmentation</em></span>).</p>
<h3 id="feature-space-based-techniques">Feature-Space Based Techniques</h3>
<p>Nell’ipotesi che ciascun elemento dell’immagine sia omogeneo e definito da una ben nota primitiva (<span><em>feature</em></span>) possibile raggruppare i pixels che la soddisfano considerandoli come un’unica unit(<span><em>cluster</em></span>). Alternativamente possibile costruire un particolare istogramma, definito nello spazio delle <span><em>features</em></span>, e dalla sua analisi determinare uno o pivalori di soglia (<span><em>binarization &amp; multilevel thresholding</em></span>) che suddividono lo spazio in un certo numero di classi.</p>
<p>Il difetto di tali approcci che non tengono in conto la morfologia dei clusters individuati trascurando le relazioni spaziali di vicinanza fra le features. A causa dei disturbi dovuti alle condizioni di illuminazione probabile che si abbiano i clusters principali non compatti e ben definiti, come dovrebbero risultare, ma interroti da altri clusters piccoli o piccolissimi che possono complicare o falsare i successivi passi di analisi e riconoscimento degli oggetti visualizzati.</p>
<h3 id="image-domain-based-techniques">Image-Domain Based Techniques</h3>
<p>Per garantire anche quest’ultima condizione di compattezza necessario introdurre delle condizioni che tengano conto della distribuzione spaziale delle features.</p>
<h4 id="tecniche-di-split-merge-e-region-growing">Tecniche di Split &amp; Merge e Region Growing</h4>
<p>Le prime suddividono ricorsivamente (<span><em>split</em></span>) l’immagine in unitsempre pipiccole fino ad ottenere una partizione omogenea; successivamente procedono alla fusione (<span><em>merge</em></span>) di clusters vicini, appartenenti in generale a due rami differenti della ripartizione, che si possano considerare omogenei fra loro.</p>
<p>Le seconde invece partono dalla definizione di alcuni nuclei iniziali, <span><em>semi</em></span> e progressivamente li accrescono agglomerando i punti vicini che soddisfano il criterio di prossimità, o omogeneit, fissato.</p>
<p>In entrambe le classi di algoritmi rilevante la scelta del criterio di omogeneit, il predicato <span class="math">$\cal O$</span>, che generalmente viene definito come funzione che misura la distanza fra le classi in relazione alla <span><em>distribuzione delle features al loro interno</em></span> <span class="citation" data-cites="Puzicha"></span>. Nello stesso articolo sottolineato il fatto che non possibile stabilire una misura che sembri offrire delle prestazioni superiori alle altre in ogni applicazione, ma che comunque alcune si comportano meglio in determinate ipotesi di lavoro. Nel caso della segmentazione risulta che la scelta mediamente soddisfacente in termini di errore di ripartizione la <span class="math"><em>χ</em><sup>2</sup> − <em>s</em><em>t</em><em>a</em><em>t</em><em>i</em><em>s</em><em>t</em><em>i</em><em>c</em><em>s</em></span>.</p>
<p>Inoltre nel caso delle tecniche ad accrescimento tipo <span><em>region growing</em></span> problematica anche la decisione dei punti di aggregazione iniziali i quali possono essere fissati in corrispondenza dei punti di minimo del modulo del gradiente del colore dell’immagine, a cui corrispondono regioni abbastanza uniformi, oppure realizzando una opportuna quantizzazione dei colori presenti, o pisemplicemente distribuendo i semi in modo uniforme.</p>
<h4 id="tecniche-basate-sulla-rilevazione-dei-bordi-edge">Tecniche basate sulla rilevazione dei bordi (<span><em>Edge</em></span>)</h4>
<p>Alla stessa classe di algoritmi appartengono quelli che realizzano la segmentazione individuando i bordi (<span><em>edge</em></span>), ciol’insieme dei punti di transizione, e quindi a maggior contrasto, fra una regione omogenea e l’altra. Nel caso di immagini scalari, in cui presente la sola componente di intensità, esistono diversi algoritmi ottenuti applicando all’immagine un opportuno operatore, Sobel, Kirsch, pseudo-Laplace, LoG (Mexican-hat), morfologici <span class="citation" data-cites="Zamperoni"></span> o il pinoto filtro di Canny <span class="citation" data-cites="Canny"></span> che rappresenta il filtro lineare ottimo, nel caso unidimensionale e con rumore gaussiano bianco, che soddisfa le seguenti condizioni bassa probabilitdi mancare un buon edge e bassa probabilitdi considerare vero un falso edge; ovvero massimizzare l’<span class="math"><em>S</em><em>N</em><em>R</em></span> in uscita al filtro; corretta localizzazione dell’edge. Il risultato un filtro le cui prestazioni possono essere ottenute, con buona approssimazione, anche dalla derivata prima, <span class="math"><em>G</em><sub><em>σ</em></sub><sup> ′</sup> (<em>x</em>)</span>, della gaussiana <br /><span class="math">$$G_\sigma(x)\,=\,\frac{1}{\sigma\,\sqrt{2\,\pi}}\exp\,\Big(\,-\,\frac{x^2}{2\,\sigma^2}\,\Big);$$</span><br /> e quindi gli edges sono determinati dalla convoluzione <br /><span class="math"><em>C</em>(<em>x</em>)  =  <em>G</em><sub><em>σ</em></sub><sup> ′</sup>(<em>x</em>) * <em>I</em>(<em>x</em>)  =  ( <em>G</em><sub><em>σ</em></sub>(<em>x</em>) * <em>I</em>(<em>x</em>) )<sup> ′</sup></span><br /> per le proprietdel filtro gaussiano.</p>
<p>(5)</p>
<p>L’estensione al caso bidimensionale ottenuta tenendo presente che si deve ora considerare il gradiente di <span class="math"><em>G</em><sub><em>σ</em></sub>(<em>x</em>, <em>y</em>)</span> <br /><span class="math"><em>C</em>(<em>x</em>, <em>y</em>)  =  ∇<em>G</em><sub><em>σ</em></sub> * <em>I</em>  =  ∇( <em>G</em><sub><em>σ</em></sub> * <em>I</em> )  =  ∇( <em>G</em><sub><em>σ</em></sub>(<em>x</em>) * ( <em>G</em><sub><em>σ</em></sub>(<em>y</em>) * <em>I</em> ) )</span><br /> dove le ultime due uguaglianze sono valide ancora per le prorpietdella gaussiana.</p>
<p>Noto <span class="math"><em>C</em></span> possibile determinare l’orientazione dell’<span><em>edgel</em></span> (edge element) dalle componenti di <span class="math"><em>C</em>  /  ∣<em>C</em>∣</span> mentre la sua altezza dal modulo <span class="math">∣<em>C</em>∣</span>.</p>
<p>E’ possibile che fra gli <span><em>edgel</em></span> determinati ve ne siamo molti non desiderati dovuti ad esempio alla tessitura delle superfici o ad altri disturbi che non sono eliminati dalla convoluzione col filtro passa basso <span class="math"><em>G</em><sub><em>σ</em></sub></span>. Si potrebbe pensare di poter aumentare la scala <span class="math"><em>σ</em></span>, ma ciøvorrebbe dire ridurre la capacitdi localizzazione degli edge; invece si fissa un valore di soglia per la scala utilizzata in modo da scartare gli edge che hanno un’intensitinferiore.</p>
<p>Il problema appena individuato dovuto alla due condizioni strutturali rispetto le quali stato definito il filtro e che non possono essere soddisfatte contemporaneamente; infatti una migliore realizzazione della prima porta un degrado della seconda, e viceversa. La scelta dei parametri quindi frutto di un compromesso (<span><em>trade-off</em></span>) fra le due.</p>
<p>Esistono inoltre delle situazioni in cui il filtro di Canny puøfallire: nel caso di un’area dell’immagine con un gradiente di intensitche costante ma non nullo il filtro puødecidere per la presenza di edges quando invece non dovrebbero esserci; se si in presenza di edge composito, per esempio gradino pirampa, si ha un errore sistematico nella localizzazione dell’edge stesso; non riesce ad individuare le giunzioni a <span class="math"><em>T</em></span> che si hanno quando tre regioni distinte e adiacenti l’una all’altra.</p>
<p>Una delle cause dei problemi appena menzionati la natura lineare del filtro; infatti mostrato in <span class="citation" data-cites="Perona90"></span> che per ogni famiglia finita di filtri lineari esiste un <span><em>edgel</em></span> composito per cui le risposte presentano un errore sistematico. Sempre in <span class="citation" data-cites="Perona90"></span> fornita la soluzione al problema che data dalla scelta di una diversa classe di filtri ottenuti come combinazione di filtri in quadratura tra loro. Dalla convoluzione tra questi e l’immagine, ed elevando al quadrato il modulo, si ottiene una forma quadratica che individua l’<span><em>edgel</em></span> nel suo punto di estremo. Tale forma quadratica dipende anche dalla fase e quindi l’estremo determinato permette di definire l’orientazione dell’<span><em>edgel</em></span> in modo pipreciso rispetto al caso precedente, con una risoluzione che possibile stabilire a priori. Un altro grado di libertdato dalla forma della coppia di filtri che vincolabile fissando un criterio che condizioni gli <span><em>edgel</em></span> risultanti: un elevato <span class="math"><em>S</em><em>N</em><em>R</em></span>, come nel caso di Canny, minima varianza dell’errore di localizzazione, bassa probabilitdi <span><em>edgel</em></span> multipli (ciofalsi <span><em>edgel</em></span> dovuti al ripple del filtro e che si affiancano a quelli veri), etc.</p>
<p>(5)</p>
<p>Nel caso delle immagini a colori si possono applicare gli stessi metodi previa l’estensione della nozione di gradiente nel caso di immagini vettoriali che realizzabile in due modi: calcolare per ciacuna componente il gradiente e quindi combinare opportunamente i risultati parziali; definire l’estensione del calcolo del gradiente per funzioni vettoriali <span class="citation" data-cites="Gevers"></span>, <span class="citation" data-cites="Lucchese"></span></p>
<p>Sia definita l’immagine <br /><span class="math">$${\bf \Psi}({\bf x}):\,\M(R)^2\,\longrightarrow\,\M(R)^N$$</span><br /> la variazione di <span class="math">${\bf \Psi}({\bf x})$</span>, <span class="math">$d{\bf \Psi}$</span>, per uno spostamento infinitesimo <span class="math">$d{\bf x}$</span> espressa dalla forma differenziale <br /><span class="math">$$d{\bf \Psi}\,=\,\frac{\,\partial {\bf \Psi}}{\partial x}\,dx\,+
                  \,\frac{\,\partial {\bf \Psi}}{\partial y}\,dy$$</span><br /> la cui norma al quadrato risulta <br /><span class="math">$$d{\bf \Psi}^2\,=\,d{\bf x}^T\,G\,d{\bf x}$$</span><br /> dove <span class="math"><em>G</em></span> una matrice <span class="math">(2 × 2)</span> le cui componenti sono <br /><span class="math">$$g_{ij}\,=\,\frac{\partial {\bf \Psi}}{\partial x_i}
             \,\frac{\partial {\bf \Psi}}{\partial x_j}.$$</span><br /> Le direzioni di estremo della forma quadratica sono definite dagli autovettori di <span class="math"><em>G</em></span>, mentre gli autovalori associati stabiliscono l’altezza del-l’estremo; quindi riferendoci all’immagine di partenza, gli autovettori indicano le direzioni di massima e minima variazione, mentre gli autovalori l’entitdella variazione rispetto al punto <span><strong>x</strong></span>.</p>
<p>(5)</p>
<p><span><em>La ripidit(<span><em>sharpeness</em></span>) dell’immagine nel punto, ovvero il “<span><em>gradiente</em></span>”, puøessere definito dalla radice quadrata della differenza dei due autovalori; cosfacendo si ottenuto in una sola misura l’informazione sulle variazioni di grandezza vettoriali</em></span>.</p>
<p>Rispetto all’immagine originale costituita da tutti i suoi <span><em>pixels</em></span>, quindi possibile ottenere una rappresentazione picompatta considerando gli <span><em>edgels</em></span> ricavati con uno degli edge-detector menzionati. Il grado di compressione risulta dipendente dall’immagine considerata in quanto vi possono essere comunque un numero elevato di elementi in base anche alla scelta del valore di soglia fissato; inoltre la rappresentazione non tiene conto della possibile continuitdegli edgels, rendendo difficoltosa l’interpretazione degli oggetti, o di loro parti, individuati.</p>
<p>Per ovviare a questo inconveniente si puøricorrere ad un’altra classe di modelli denominati <span><strong>active contours</strong></span> o <span><em>snakes</em></span>, originalmente proposti da Kass <span class="citation" data-cites="Kass"></span> e rielaborati nel caso particolare delle immagini a colori nei <span><em>color snakes</em></span> <span class="citation" data-cites="Gevers"></span> dove si sfrutta la definizione data sopra sul calcolo del gradiente per immagini vettoriali.</p>
<p>(5)</p>
<p><span><em>Tale modello rappresenta uno degli elementi fondamentali dell’algoritmo proposto in questa tesi e sarperciøapprofondito nei prossimi capitoli</em></span>.</p>
<h4 id="tecniche-di-classificazione-basate-sulle-reti-neuronali">Tecniche di classificazione basate sulle reti Neuronali</h4>
<p>Una rete neuronale <span class="citation" data-cites="Bose"></span> costituita da uno o pistrati (<span><em>multi-layer</em></span>), esclusi quello d’ingresso e quello di uscita, di celle elementari, i <span><em>neuroni</em></span>. Ciascun neurone costituito da due elementi: il primo, denominato <span><em>adaptive linear combiner</em></span>, riceve in ingresso i segnali provenienti dai neuroni dello strato che lo precede e li combina linearmente secondo dei coefficienti, <span><em>pesi sinattici</em></span>; mentre il secondo una particolare funzione, <span><em>legge di attivazione</em></span> che elabora il risulato della combinazione determinando il nuovo stato del neurone, che rappresenta l’uscita che si propaga agli strati successivi. Esempi di leggi di attivazione sono la funzione segno, la rampa lineare, la sigmoide <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, etc.</p>
<p>Il vantaggio di presentare una struttura intrinsecamente parallela, che puørisultare determinante in termini di tempo di calcolo, oltre ad un buon comportamento nei confronti dei disturbi, controbilanciato dallo svantaggio di richiedere una fase di apprendimento (<span><em>learning</em></span>) in cui vengono adattati i pesi sinattici in relazione alle caretteristche del <span><em>pattern</em></span> in esame.</p>
<p>Esistono due tipi principali di apprendimento: : deve essere disponibile una collezione, <span><em>training set</em></span>, di coppie <span class="math"><em>I</em> / <em>O</em></span>. Le leggi di apprendimento sono definite in modo che sia minimo l’errore in uscita fra il valore desiderato e quello reale fornito dalla rete, una volta fissati i pesi.</p>
<p>Gli algoritmi si suddividono quindi in <span><em>algoritmi a correzione d’errore</em></span> (<span class="math"><em>α</em> − <em>L</em><em>M</em><em>S</em></span> o Widrow-Hoff Delta, MRI, MRII) e <span><em>algoritmi a discesa lungo il gradiente dell’errore</em></span> (<span class="math"><em>μ</em> − <em>L</em><em>M</em><em>S</em></span>, Back-Propagation) sviluppati in base al tipo di rete (single-layer, AdaLinE o multi-layer, M-AdaLinE). : in questo caso non disponibile un insieme di prova ma la rete che aggiorna il suo comportamento in relazione al tipo di ingressi. Si realizza una struttura basata su rapporti di associazione tra un dato tipo di ingresso una quota di neuroni che risultano particolarmente attivi quando questi si presenta e che fissata incrementando il valore dei rispettivi pesi sinattici. Uno dei modelli di rete che utilizza questo tipo di apprendimento dato dalle reti di Kohonen o <span class="math"><em>S</em><em>O</em><em>M</em></span> (<span><em>Self Organizing Map</em></span>).</p>
<p>Un’altra importante tipologia di reti data dalle <span><em>reti di Hopfield</em></span> che presentano carateristiche peculiari: a differenza dei modelli precedenti in cui i segnali si propagano in una sola direzione dall’ingresso verso l’uscita (<span><em>feed-forward</em></span>), queste presentano anche dei collegamenti in retroazione (<span><em>feed-back</em></span>) dato che ciascun nodo della rete, il neurone, collegato con tutti gli altri (<span><em>fully-connected</em></span>); per cui non pipossibile una organizzazione a strati; una volta annullato l’ingresso l’evoluzione dello stato del neurone puøraggiungere una condizione di equilibrio stabile, con l’esaurimento del transitorio, oppure rimanere in uno di stato di instabilitcon oscillazioni permanenti; vengono utilizzate nella risoluzione di problemi di ottimizzazione nella minimizzazione di <span><em>funzioni costo</em></span> che possono, nel nostro caso, rappresentare dei vincoli per la segmentazione. In particolare i minimi di tali funzioni corrispondono agli stati finali stabili, o attrattori stabili, della rete.</p>
<h3 id="physics-based-techniques">Physics Based Techniques</h3>
<p>Sostanzialmente non differiscono dalle precedenti se non nel fatto che inseriscono dei termini che tengano conto del comportamento fisico delle superfici dei materiali, in termini di riflessione, al variare delle condizioni di illuminazione. Puørisultare infatti che la superficie di uno stesso materiale, caratterizzata da un solo colore, puøapparire invece non uniforme con possibili problemi di sovrasegmentazione in quanto si individuano piregioni di quelle reali. In generale i materiali sono suddivisi in tre categorie: dielettrici otticamente omogenei, dielettrici otticamente non omogenei e metalli; per ciasuna delle quali definibile un modello che rappresenti i fenomeni di riflessione della superficie che determinano il colore percepito. Tali modelli tengono conto della geometria e del tipo di superficie, della posizione relativa sorgente-soggetto, della natura della sorgente (la lunghezza d’onda della luce emessa) ovvero se sia luce bianca o abbia delle componenti monocromatiche prevalenti. In alcuni casi permettono di determinare le diverse componenti di riflessione dovuti anche alle interazioni fra gli oggetti presenti fra cui necessariamente il sensore che effettua la misura.</p>
<h2 id="texture-segmentation">Texture segmentation</h2>
<p>Come accennato precedentemente le tecniche utilizzate nella segmentazione sono valide sia che si consideri il solo colore sia che si consideri la tessitura (<span><em>texture</em></span>) sia che vengano utilizzate entrambe.</p>
<p>A differenza del colore che una proprietpuntuale, la tessitura da una descrizione locale delle relazioni spaziali fra pixel vicini; inoltre dipende dalla scala utilizzata, ovvero ad un determinato livello di risoluzione alcuni dettagli possono non essere presenti mentre lo sono se la si aumenta, come se si analizzasse la stessa superficie a diversi gradi di ingrandimento.</p>
<p>Per cui gli algoritmi di analisi della tessitura fanno largo utilizzo di metodi a multirisoluzione con strutture tipo <span><em>piramide di immagini</em></span> a cui sono applicate filtri la cui forma dipende dalla scala del livello.</p>
<p>Vista la caratteristica che devono avere i filtri una delle scelte comunemente adottate data dal filtro gaussiano <span class="math"><em>G</em><sub><em>σ</em></sub></span>, il cui fattore di forma dato dalla sua varianza, oppure, per problemi picomplessi, dalla famiglia di filtri complessi che vanno sotto il nome di <span><em>filtri di Gabor</em></span> <br /><span class="math">$$G_\sigma({\bf x},{\bf k})\,=\,\frac{1}{\sigma\,\sqrt{2\,\pi}}
                           \exp\,\Big(\,-\,\frac{{\bf x}^T\,{\bf x}}{2\,\sigma^2}\,\Big)
                           \exp\,\Big(\,{\mit i}\,{\bf k}^T\,{\bf x}\,\Big)$$</span><br /> con <span class="math"><em>σ</em></span> funzione di <span class="math">${\bf k}$</span>, il pararmetro che caratterizza la feature di interesse. Si considera quindi il modulo della convoluzione tra il filtro e l’immagine data ottenendo, per ogni pixel, ad un dato livello di risoluzione, un vettore <span class="math"><em>n</em> − <em>d</em><em>i</em><em>m</em><em>e</em><em>n</em><em>s</em><em>i</em><em>o</em><em>n</em><em>a</em><em>l</em><em>e</em></span> dei coefficienti di Gabor che descrive le relazioni spaziali tra il pixel in esame e quelli prossimi.</p>
<p>Per caratterizzare l’intera tessitura opportuno ora considerare la distribuzione di tali features nell’intorno del pixel sfruttando le considerazioni viste precedentemente nella sezione () oppure quanto suggerito in <span class="citation" data-cites="Puzicha"></span>.</p>
<p>(3)</p>
<p>Il problema appena esposto puøessere visto in una forma piğenerale considerando la matrice delle mutue occorrenze (<span><em>co-occurrence matrix</em></span>) (si veda a proposito <span class="citation" data-cites="Haralick92"></span>): .</p>
<p>Dati l’insieme <span class="math"><em>Q</em></span> delle primitive (features) in cui scomposta l’immagine e l’insieme <span class="math"><em>A</em></span> degli attributi associati ad ogni primitiva (ad esempio l’intensi-tà) dalla funzione <span class="math"><em>f</em></span>, si definisca una relazione binaria <span class="math"><em>S</em>  ⊆  <em>Q</em> × <em>Q</em></span> che esprima la relazione spaziale che intercorre fra ogni coppia di features <span class="math">(<em>q</em><sub><em>i</em></sub>, <em>q</em><sub><em>j</em></sub>)</span> (distanza, adiacenza, etc.). Si definisce la matrice delle occorrenze mutue <br /><span class="math">$$P(a_i,a_j)\,=\frac{\M(\#)\,\{\,(q_i,q_j)\,\in\,S\,:\,f(q_i)=a_i,\,f(q_j)=a_j\,\}}{\M(\#)\,S}$$</span><br /></p>
<p>che rappresenta in termini di frequenze relative la distribuzione delle feature in <span class="math"><em>S</em></span>.</p>
<p>Una volta ottenuta le distribuzioni <span class="math"><em>P</em><sub>1</sub></span> e <span class="math"><em>P</em><sub>2</sub></span> di due regioni <span class="math"><em>S</em><sub>1</sub></span> e <span class="math"><em>S</em><sub>2</sub></span> e possibile applicare i diversi criteri di omogeneito similarit.</p>
<p>(3)</p>
<p>Altre tecniche per descrivere la tessitura sono basate sull’analisi dell’im-magine nel dominio della frequenza, anche se poco utilizzato, sull’uso di operatori morfologici, attraverso la definizione di edge per regioni a tessitura differente, sulla sintesi di particolari modelli <span><em>ARMA</em></span> o modellando la tessitura come un processo aleatorio e ricorrendo a un <span><em>Discrete Markov Random Field</em></span>.</p>
<h2 id="binarizzazione">Binarizzazione</h2>
<p>Nell’ambito delle <span><em>Feature-Space Based Techniques</em></span> () si accennato a <span><em>binarization &amp; multilevel thresholding</em></span> per la determinazione dei valori di soglia che realizzano la ripartizione dello spazio delle <span><em>features</em></span>.</p>
<p>Si prende ora in considerazione il caso in cui tali <span><em>features</em></span> siano l’intensito una componente dei modelli per la rappresentazione del colore. Nonostante le limitazioni di tali tecniche segnalate in (), queste possono comunque rappresentare una soluzione all’inizializzazione degli <span><em>active contours</em></span> ().</p>
<h3 id="binarizzazione-come-tecnica-di-segmentazione">Binarizzazione come tecnica di segmentazione</h3>
<p>Nel caso in cui l’immagine si possa ritenere bimodale (<span><em>foreground &amp; background</em></span>), ad esempio due oggetti di colori diversi, il testo e la pagina su cui scritto, possibile aumentare la discriminazione fra i diversi elementi determinando un opportuno valore di soglia.</p>
<p>La binarizzazione (<span><em>binarization</em></span> or <span><em>spatial thresholding</em></span>) rappresenta perciøuna delle prime forme di segmentazione sviluppata per le immagini in scala di grigio e successivamente estesa alle immagini a colori <span class="citation" data-cites="Lucchese"></span>.</p>
<p>Per ridurre i tempi di calcolo possibile calcolare la soglia analizzando l’istogramma dei valori di un’opportuna “intensit”, che puøessere direttamente l’immagine a toni di grigio o una o picomponenti delle possibili rappresentazioni delle immagini a colori (<span class="math"><em>R</em><em>G</em><em>B</em></span>, <span class="math"><em>H</em><em>S</em><em>I</em></span>) e delle loro trasformate (<span><em>trasformata di Hotelling</em></span>) opportunamente combinate.</p>
<p>(5)</p>
<p>Una volta realizzato l’istogramma questi viene normalizzato ottenendo un vettore di frequenze relative intese come la distribuzione di probabilitper i livelli di intensitdella primitiva considerata.</p>
<p>Se <span class="math"><em>N</em>(<em>i</em>)</span> il numero di pixels con intansit<span class="math"><em>i</em></span> e <span class="math"><em>N</em></span> il numero totale di pixels, la frequenza relativa risulta <br /><span class="math">$$P\,(i)\,=\,\frac{N(i)}{N}$$</span><br /> La distribuzione ottenuta la descrizione statistica dell’intensitdei punti dell’immagine, per cui possibile applicare un qualsiasi metodo di classificazione supervisionato e non supervisionato (<span><em>supervised &amp; unsupervised</em></span>) che permetta di costruire una funzione discriminante. Il caso pisemplice prevede che tale funzione sia costante e pari al valore della soglia, oppure si puøintrodurre un’isteresi che permette di ridurre gli effetti delle oscillazioni dell’intensitnell’intorno del valore di soglia, in modo da rendere la binarizzazione pirobusta e ottenere delle regioni piŭniformi.</p>
<h4 id="un-algoritmo-iterativo">Un algoritmo iterativo</h4>
<p>A partire da un valore di soglia iniziale, che puøessere il valore medio della scala di intensit, si procede con approssimazioni successive che portano ad una soluzione finale che si arresta quando la differenza fra due stime successive inferiore ad uno scarto <span class="math"><em>ɛ</em></span> fissato.</p>
<p>Il numero di livelli <span class="math"><em>L</em></span> su cui quantizzata l’intensitsolitamente pari a <span class="math">256</span> che corrisponde ad un’occupazione di memoria di un <span class="math"><em>b</em><em>y</em><em>t</em><em>e</em></span> per ciascun pixel e quindi i valori <span class="math"><em>i</em></span> che puøassumere appartengono alla sequenza <span class="math">{0, …, <em>L</em> − 1}</span>.</p>
<p>Si fissa la soglia iniziale <span class="math"><em>s</em> = (<em>L</em> − 1) / 2</span>.</p>
<p><span class="math"><em>s</em><sub><em>a</em></sub>  =  <em>s</em></span> (2) Q<sub>0</sub>=<sub>i=0</sub><sup>s </sup>P(i) &amp; <sub>0</sub>=<sub>i=0</sub><sup>s </sup>i<br />&amp;<br />Q<sub>1</sub>=<sub>i=s+1 </sub><sup>L-1</sup>P(i) &amp; <sub>1</sub>=<sub>i=s+1 </sub><sup>L-1</sup>i<br /></p>
<p>Aggiornamento della stima di <span class="math"><em>s</em></span> s &amp; = &amp; Q<sub>0</sub>Q<sub>1</sub>0<br />s &amp; = &amp; <sub>0</sub> Q<sub>0</sub>0Q<sub>1</sub>=0<br />s &amp; = &amp; <sub>1</sub> Q<sub>0</sub>=0Q<sub>1</sub>0</p>
<p>Se <span class="math">∣ <em>s</em>  −  <em>s</em><sub><em>a</em></sub> ∣  ≤  <em>ɛ</em></span>l’algoritmo termina altrimenti si torna al <span>Passo 1</span>.</p>
<p>Il numero di passi ovviamente funzione della tolleranza <span class="math"><em>ɛ</em></span> fissata, comunque generalmente il procedimento si arresta dopo pochi passi. La soglia ottenuta tale da minimizzare</p>
<p><br /><span class="math">∑ <sub><em>i</em> = 0</sub><sup>⌊<em>s</em>⌋</sup> ( <em>i</em> − <em>μ</em><sub>0</sub> )<sup>2</sup> <em>P</em>(<em>i</em>)  +  ∑ <sub><em>i</em> = ⌊<em>s</em> + 1⌋</sub><sup><em>L</em> − 1</sup> ( <em>i</em> − <em>μ</em><sub>1</sub> )<sup>2</sup> <em>P</em>(<em>i</em>)</span><br /></p>
<p>che esprime la somma delle varianze dei due gruppi di pixels in cui ripartita l’immagine.</p>
<h3 id="binarizzazione-come-problema-di-classificazione">Binarizzazione come problema di classificazione</h3>
<p>Come accennato precedentemente possibile intendere la binarizzazione co-me la soluzione di un problema di classificazione dove la funzione discriminante costante e pari alla soglia. La capacitdel classificatore dipende dalla conoscenza delle caratteristiche dei dati da analizzare e quanto queste informazioni siano descritte dal classificatore stesso. In alcuni casi possibile ritenere che la descrizione statistica dell’intensitdei pixels dell’immagine, descritta attraverso il suo istogramma normalizzato, sia approssimabile alla combinazione di due gaussiane centrate attorno a due valori medi ben distinti e con varianze sufficientemente piccole in modo che non vi sia una eccessiva interferenza, ciosia abbastanza netta la zona di separazione in cui cadrsicuramente il valore di soglia.</p>
<p>Con queste ipotesi risulta semplice considerare, ad esempio, il criterio della minimizzazione della <span><em>distanza di Kullback</em></span> <span class="math"><em>J</em></span> definita</p>
<p><br /><span class="math">$$J\,=\,\sum_{i=0}^{L-1}\,P(i)\,\log\frac{P(i)}{f(i)}$$</span><br /></p>
<p>dove <span class="math"><em>f</em>(<em>i</em>)  =  <em>Q</em><sub>0</sub> <em>g</em><sub>0</sub>(<em>i</em>)  +  <em>Q</em><sub>1</sub> <em>g</em><sub>1</sub>(<em>i</em>)</span> la distribuzione di massa ottenuta come combinazione pesata di due distribuzioni gaussiane <span class="math"><em>g</em><sub>0</sub></span> e <span class="math"><em>g</em><sub>1</sub></span> i cui pesi sono le probabilitrelative dei due gruppi.</p>
<p>(5)</p>
<p>Un’altra soluzione data dall’algoritmo proposto da Otsu <span class="citation" data-cites="Otsu"></span>, <span class="citation" data-cites="Haralick92"></span>,<span class="citation" data-cites="Zamperoni"></span> Si definisce <span class="math"><em>s</em></span>, soglia, il valore che minimizza la somma pesata <span class="math"><em>σ</em><sub><em>W</em></sub><sup>2</sup></span> (<span><em>within-group variance</em></span>) delle varianze dei due gruppi <span class="math">Ω <sub>0</sub></span> e <span class="math">Ω <sub>1</sub></span> risultati dalla binarizzazione.</p>
<p>Definiti i parametri (2) q<sub>0</sub>(t)=<sub>i=0</sub><sup>t</sup>P(i) &amp; q<sub>1</sub>(t)=<sub>i=t+1</sub><sup>L-1</sup>P(i)<br />&amp;<br /><sub>0</sub>(t)=<sub>i=0</sub><sup>t</sup>i &amp; <sub>1</sub>(t)=<sub>i=t+1</sub><sup>L-1</sup>i<br />&amp;<br /><sub>0</sub><sup>2</sup>(t)=<sub>i=0</sub><sup>t</sup>[i-<sub>0</sub>(t)]<sup>2</sup> &amp; <sub>1</sub><sup>2</sup>(t)=<sub>i=t+1</sub><sup>L-1</sup>[i-<sub>1</sub>(t)]<sup>2</sup></p>
<p><sub>W</sub><sup>2</sup>=q<sub>0</sub>(t)<sub>0</sub><sup>2</sup>(t)+q<sub>1</sub>(t)<sub>1</sub><sup>2</sup>(t)</p>
<p>il valore di soglia <span class="math"><em>s</em></span> puøessere ottenuto s=<sub>t</sub>{<sub>W</sub><sup>2</sup>(t)}</p>
<p>Un’algoritmo piĕfficiente realizzabile rielaborando le espressioni precedenti ottenendo una formulazione duale che consideri il valore di soglia che massimizzi la varianza fra le due classi <span class="math">Ω <sub>0</sub></span> e <span class="math">Ω <sub>1</sub></span> (<span><em>between-group variance</em></span>) <sub>B</sub><sup>2</sup>(t)=q<sub>0</sub>(t)[<sub>0</sub>(t)-]<sup>2</sup>+q<sub>1</sub>(t)[<sub>1</sub>(t)-]<sup>2</sup></p>
<p>con <span class="math">$\ds \mu\,=\,\sum_{i=0}^{L-1}\,i\,P(i)$</span> media totale.</p>
<p>Una volta sviluppata l’espressione genarale della varianza totale <span class="math">$\ds \sigma^2\,=\,\sum_{i=0}^{L-1}\,[i-\mu]^2\,P(i)$</span> possibile scomporre la sommatoria nei due termini di estremi <span class="math">{0, <em>t</em>}</span> e <span class="math">{<em>t</em> + 1, <em>L</em> − 1}</span> per ottenere, tenendo conto dei parametri definiti precedentemente, l’equazione <sup>2</sup> &amp; = &amp; q<sub>0</sub>(t)<sub>0</sub><sup>2</sup>(t)+q<sub>1</sub>(t)<sub>1</sub><sup>2</sup>(t)+<br />&amp; &amp; +q<sub>0</sub>(t)[<sub>0</sub>(t)-]<sup>2</sup>+q<sub>1</sub>(t)[<sub>1</sub>(t)-]<sup>2</sup></p>
<p>nella quale si riconoscono le due componenti <span class="math"><em>σ</em><sub><em>W</em></sub><sup>2</sup>(<em>t</em>)</span> e <span class="math"><em>σ</em><sub><em>B</em></sub><sup>2</sup>(<em>t</em>)</span> definite, rispettivamente, dalle () e ().</p>
<p>Dato che <span class="math"><em>σ</em><sup>2</sup></span> indipendente da t, costante una volta fissata <span class="math"><em>P</em>(<em>i</em>)</span>, se <span class="math"><em>σ</em><sub><em>W</em></sub><sup>2</sup>(<em>t</em>)</span> diminuisce allora <span class="math"><em>σ</em><sub><em>B</em></sub><sup>2</sup>(<em>t</em>)</span> necessariamente deve aumentare e il risultato che si ottiene la soluzione del problema duale del precedente ()</p>
<p>s=<sub>t</sub>{<sub>B</sub><sup>2</sup>(t)}</p>
<p>Sfruttando le relazioni (2) =q<sub>0</sub>(t)<sub>0</sub>(t)+q<sub>1</sub>(t)<sub>1</sub>(t) &amp; eq<sub>1</sub>(t)=1-q<sub>0</sub>(t)</p>
<p>quest’ultima ricavata da <span class="math">$\ds \sum_{i=0}^{L-1}\,P(i)\,=\,1$</span>, che vale perche’ <span class="math"><em>P</em>(<em>i</em>)</span> una funzione distribuzione di massa, si ottiene un’ulteriore semplificazione <sub>B</sub><sup>2</sup>(t)=q<sub>0</sub>(t)[1-q<sub>0</sub>(t)][<sub>0</sub>(t)-<sub>1</sub>(t)]<sup>2</sup></p>
<p>a cui possono essere associate le espressioni ricorsive q<sub>0</sub>(t+1) &amp; = &amp; q<sub>0</sub>(t)+P(t+1)<br />&amp; &amp;<br /><sub>0</sub>(t+1) &amp; = &amp;<br />&amp; &amp;<br /><sub>1</sub>(t+1) &amp; = &amp;</p>
<p>dove <span class="math"><em>μ</em></span> viene calcolata una volta per tutte non appena nota la distribuzione <span class="math"><em>P</em>(<em>i</em>)</span>, mentre gli altri termini sono aggiornati ad ogni passo sfruttando i risultati precedenti con una migliorata efficienza dell’algoritmo rispetto alla formulazione originale.</p>
<h1 id="descrizione-a-b-splines-di-una-curva-nel-piano">Descrizione a B-splines di una curva nel piano</h1>
<h2 id="introduzione-1">Introduzione</h2>
<p>Descrivere la curva <span class="math">${\bf r}(u,t)$</span> in termini di spline significa determinare le due funzioni <span class="math"><em>x</em>(<em>u</em>, <em>t</em>)</span> e <span class="math"><em>y</em>(<em>u</em>, <em>t</em>)</span>, componenti di <span class="math">${\bf r}$</span>, note appunto come splines, ottenute dalla composizione di segmenti di funzioni polinomiali o <span><em>spans</em></span>. Le <span><em>B-splines</em></span> rappresentano una particolare classe di splines in cui la funzione <span class="math"><em>x</em>(<em>u</em>, <em>t</em>)</span> ottenuta come combinazione lineare di <span class="math"><em>N</em><sub><em>B</em></sub></span> funzioni base (da cui B-spline) <span class="math"><em>B</em><sub><em>i</em></sub>(<em>u</em>)</span>, e con combinatori i <span><em>control points</em></span> <span class="math"><em>x</em><sub><em>i</em></sub>(<em>t</em>)</span>, <span class="math"><em>i</em> = 0, …, <em>N</em><sub><em>B</em></sub> − 1</span> x(u,t)=<sub>i=0</sub><sup>N<sub>B</sub>-1</sup>B<sub>i</sub>(u)x<sub>i</sub>(t).</p>
<p>Ciascuna base <span class="math"><em>B</em><sub><em>i</em></sub></span> definita dall’unione di <span class="math"><em>d</em></span> segmenti di polinomio di ordine <span class="math"><em>d</em></span> o di grado <span class="math"><em>d</em> − 1</span> a supporto finito dato dall’intervallo <span class="math">[<em>u</em><sub><em>i</em></sub>, <em>u</em><sub><em>i</em> + <em>d</em></sub>[</span> dove ciascun <span class="math"><em>u</em><sub><em>i</em></sub></span> rappresenta il <span><em>nodo</em></span> o <span><em>knot</em></span> <span class="math"><em>i</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>o</em></span> della splines. Nel caso particolare delle <span><em>B-splines uniformi</em></span> la sequenza di nodi <span class="math">{<em>u</em><sub><em>i</em></sub>}</span> equispaziata per cui si considera <span class="math">${\bf r}(s,t)$</span> per ciascun span, con <br /><span class="math">$$s=\frac{u-u_i}{u_{i+1}-u_i}\in [0,1[ \quad e \quad u\,\in\,[\,u_i,u_{i+1}\,[.$$</span><br /></p>
<p>Si fissa inoltre che ciascuna base presenti anche delle condizioni di regolarit, in particolare che siano continue le prime <span class="math"><em>d</em> − 2</span> derivate su tutto il supporto; in questo modo anche la curva <span class="math">${\bf r}(u,t)$</span> una funzione <span class="math"><em>C</em><sup><em>d</em> − 2</sup></span> su tutto il dominio.</p>
<h2 id="b-splines-lineari">B-splines lineari</h2>
<p></p>
<p>Per comprendere il significato e le proprietdei control points e delle basi conveniente considerare dapprima il caso di <span class="math"><em>d</em> = 2</span>, il pisemplice rispetto alle condizioni di regolaritfissate, che corrisponde alle <span><em>B-splines lineari</em></span> (Figura ). Il risultato l’interpolazione lineare degli stessi punti di controllo <span class="math"><em>x</em><sub><em>i</em></sub></span> dove le basi <span class="math"><em>B</em><sub><em>i</em></sub></span> sono definite su un intervallo di ampiezza pari a <span class="math">2</span> e hanno forma triangolare. Fissati quindi <span class="math"><em>m</em></span> punti o vertici di controllo si hanno <span class="math"><em>m</em> − 1</span> segmenti di retta le cui equazioni sono esprimibili rispetto al parametro <span class="math"><em>s</em></span> x<sub>i-1</sub>(s) &amp; = &amp; (1-s)x<sub>i-2</sub>+sx<sub>i-1</sub><br />x<sub>i</sub>(s) &amp; = &amp; (1-s)x<sub>i-1</sub>+sx<sub>i</sub><br />x<sub>i+1</sub>(s) &amp; = &amp; (1-s)x<sub>i</sub>+sx<sub>i+1</sub><br />x<sub>i+2</sub>(s) &amp; = &amp; (1-s)x<sub>i+1</sub>+sx<sub>i+2</sub> <br /><span class="math">$$con \quad s=\frac{u-u_i}{u_{i+1}-u_i} \quad e \quad u\,\in\,[\,u_i,u_{i+1}\,[$$</span><br /> per cui ai due estremi per <span class="math"><em>s</em> = 0</span> e <span class="math"><em>s</em> = 1</span> corrispondono a <span class="math"><em>x</em>(0) = <em>x</em><sub><em>i</em> − 1</sub></span> e <span class="math"><em>x</em>(1) = <em>x</em><sub><em>i</em></sub></span> rispettivamente.</p>
<p>In Figura sono stati tracciati i contributi di <span class="math"><em>x</em><sub><em>i</em> − 1</sub></span> e <span class="math"><em>x</em><sub><em>i</em></sub></span> ricavati dalle equazioni () dove si vede che ciascun control points interviene nella definizione dei due spans adiacenti che lo condividono. Le due funzioni tratteggiate hanno la stessa forma e altezza che varia con la posizione dei control points che possibile pensarle come le basi <span class="math"><em>B</em><sub><em>i</em></sub></span> di altezza unitaria scalate dai punti di controllo <span class="math"><em>x</em><sub><em>i</em></sub></span>. Ne risulta che modificando la posizione di un solo vertice si hanno delle variazioni locali della curva complessiva, per cui si parla di <span><em>controllabilitlocale</em></span>, che rappresenta una delle proprietfondamentali delle splines.</p>
<p>E’ possibile allora esprimere l’equazione del segmento o span () che collega i due vertici <span class="math"><em>x</em><sub><em>i</em> − 1</sub></span> e <span class="math"><em>x</em><sub><em>i</em></sub></span> come la combinazione lineare di due basi <span class="math"><em>B</em><sub><em>i</em> − 1</sub></span> e <span class="math"><em>B</em><sub><em>i</em></sub></span> x<sub>i</sub>(u)=x<sub>i-1</sub>B<sub>i-1</sub>(u)+x<sub>i</sub>B<sub>i</sub>(u) l’imitatamente all’intervallo <span class="math"><em>u</em><sub><em>i</em></sub> ≤ <em>u</em> ≤ <em>u</em><sub><em>i</em> + 1</sub></span> in cui definito lo span, con <br /><span class="math">$$B_i(u)\,=\,\cases{
           {\ds\frac{u-u_i}{u_{i+1}-u_i}} &amp; $u_i \leq u \leq u_{i+1}$ \cr
              &amp;   \cr                                                    
           {\ds\frac{u_{i+2}-u}{u_{i+2}-u_{i+1}}} &amp; $u_{i+1} \leq u \leq u_{i+2}$. \cr}$$</span><br /></p>
<p>(5)</p>
<p>Quanto appena visto puøessere esteso all’intera funzione <span class="math"><em>x</em>(<em>u</em>)</span> (o <span class="math"><em>x</em>(<em>s</em>)</span> nel caso di B-splines uniformi) e quindi anche a <span class="math"><em>y</em>(<em>s</em>)</span>; per cui l’intera curva <span class="math">${\bf r}(u,t)$</span> risulta (u,t)=<sub>i=0</sub><sup>N<sub>B</sub>-1</sup><span><strong>x</strong></span><sub>i</sub>(t)B<sub>i</sub>(u) <sub>i</sub>=(x<sub>i</sub>,y<sub>i</sub>) oppure (s,t)=<sub>i=0</sub><sup>N<sub>B</sub>-1</sup><span><strong>x</strong></span><sub>i</sub>(t)B(s-i) nel caso di B-splines uniformi dove la base <span class="math"><em>B</em><sub><em>i</em></sub></span> ottenuta semplicemente traslando la base di riferimento <span class="math"><em>B</em></span>.</p>
<h2 id="b-splines-cubiche-uniformi">B-splines cubiche uniformi</h2>
<p>Consideriamo ora il caso delle <span><em>B-spline cubiche</em></span> ovvero splines ottenute dalla combinazione di funzioni base che sono costituite da tratti di polinomi cubici (<span class="math"><em>d</em> = 4</span>). Inoltre si assuma definitivamente l’ipotesi di splines uniformi per cui i nodi o knots <span class="math"><em>u</em><sub><em>i</em></sub></span> sono equispaziati; in particolare possibile considerarli posti a distanza unitaria e quindi possono essere sostituiti con una sequenza di interi come in Figura (). Ciascuna base perciøottenuta come traslazione di una base di riferimento, come accennato precedentemente.</p>
<p></p>
<p>A differenza del caso delle B-spline lineari, quelle cubiche non passano necessariamente per i control points ma al pipossono avvicinarsi; tutto dipende dal numero dei punti di controllo e dalla loro disposizione (nel caso in cui questi siano allineati la spline deve necessariamente attraversarli).</p>
<p></p>
<p>Dalla Figura si possono individuare alcune caratteristiche della curva ottenuta dalla combinazione delle B-splines cubiche in particolare, ma che possibile estendere all’intera famiglia delle B-splines:</p>
<p>fissati <span class="math"><em>m</em></span> <span><em>control points</em></span>, con indice <span class="math"><em>i</em> = 0, …, <em>m</em> − 1</span> si hanno <span class="math"><em>m</em></span> basi <span class="math"><em>B</em><sub><em>i</em></sub></span>; la curva scomponibile in <span class="math"><em>m</em> − 3</span> <span><em>spans</em></span> che si appoggiano su <span class="math"><em>m</em> − 2</span> nodi; la spline generata si sviluppa quindi a partire dal quarto nodo <span class="math"><em>u</em><sub>3</sub></span> e termina in corrispondenza del nodo <span class="math"><em>u</em><sub><em>m</em></sub></span>.</p>
<p>In Figura rappresentata la base <span class="math"><em>B</em>(<em>s</em>)</span> di riferimento menzionata nella quale sono indicati con diverso tratto i quattro segmenti di polinomio cubico a<sub>j</sub>s<sup>3</sup>+b<sub>j</sub>s<sup>2</sup>+c<sub>j</sub>s+d<sub>j</sub> 0 j 3. Ne risultano quindi <span class="math">16</span> incognite date dai coefficienti dei polinomi che possono essere individuati in modo univoco considerando i vincoli che derivano dalla regolaritimposta precedentemente alle curve a B-spline, ovvero che siano <span class="math"><em>C</em><sup>2</sup></span> su tutto il dominio: (3) 0=b<sub>0</sub>(0) &amp; 0=b<sub>0</sub><sup>(1)</sup>(0) &amp; 0=b<sub>0</sub><sup>(2)</sup>(0)<br />b<sub>0</sub>(1)=b<sub>1</sub>(0) &amp; b<sub>0</sub><sup>(1)</sup>(1)=b<sub>1</sub><sup>(1)</sup>(0) &amp; b<sub>0</sub><sup>(2)</sup>(1)=b<sub>1</sub><sup>(2)</sup>(0)<br />b<sub>1</sub>(1)=b<sub>2</sub>(0) &amp; b<sub>1</sub><sup>(1)</sup>(1)=b<sub>2</sub><sup>(1)</sup>(0) &amp; b<sub>1</sub><sup>(2)</sup>(1)=b<sub>2</sub><sup>(2)</sup>(0)<br />b<sub>2</sub>(1)=b<sub>3</sub>(0) &amp; b<sub>2</sub><sup>(1)</sup>(1)=b<sub>3</sub><sup>(1)</sup>(0) &amp; b<sub>2</sub><sup>(2)</sup>(1)=b<sub>3</sub><sup>(2)</sup>(0)<br />b<sub>3</sub>(1)=0 &amp; b<sub>3</sub><sup>(1)</sup>(1)=0 &amp; b<sub>3</sub><sup>(2)</sup>(1)=0 che come si nota impongono la continuitfino alla derivata seconda (<span class="math"><em>d</em> − 2</span>) compresa nei punti di raccordo o <span><em>breakpoints</em></span> tra le curve polinomiali valutati per <span class="math"><em>s</em> = 0</span> e <span class="math"><em>s</em> = 1</span>.</p>
<p>Un’ultima condizione fissata imponendo che <br /><span class="math"><em>b</em><sub>0</sub>(0)  +  <em>b</em><sub>1</sub>(0)  +  <em>b</em><sub>2</sub>(0)  +  <em>b</em><sub>3</sub>(0)  =  1</span><br /> che si riduce a <br /><span class="math"><em>b</em><sub>1</sub>(0)  +  <em>b</em><sub>2</sub>(0)  +  <em>b</em><sub>3</sub>(0)  =  1</span><br /> dato che gistato fissato <span class="math"><em>b</em><sub>0</sub>(0) = 0</span>.</p>
<p>Risolvendo le equazioni nei coefficienti incogniti <span class="math"><em>a</em><sub><em>j</em></sub></span>, <span class="math"><em>b</em><sub><em>j</em></sub></span>, <span class="math"><em>c</em><sub><em>j</em></sub></span>, <span class="math"><em>d</em><sub><em>j</em></sub></span> per i quattro segmenti che compongono <span class="math"><em>B</em></span> si ricava b<sub>0</sub>(s) &amp; = &amp; s<sup>3</sup><br />&amp;<br />b<sub>1</sub>(s) &amp; = &amp; (-3s<sup>3</sup>+3s<sup>2</sup>+3s+1)<br />&amp;<br />b<sub>2</sub>(s) &amp; = &amp; (3s<sup>3</sup>-6s<sup>2</sup>+4)<br />&amp;<br />b<sub>3</sub>(s) &amp; = &amp; (-s<sup>3</sup>+3s<sup>2</sup>-3s+1)</p>
<p>Da queste possibile ottenere un’interessante espressione per lo <span><em>span</em></span> <span class="math"><em>i</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>o</em></span> definito sull’intervallo <span class="math">[<em>u</em><sub><em>i</em></sub>, <em>u</em><sub><em>i</em> + 1</sub>[</span>. A partire dalla (), trascurando per semplicitla variabile temporale, (u)=<sub>i=0</sub><sup>N<sub>B</sub>-1</sup><span><strong>x</strong></span><sub>i</sub>B<sub>i</sub>(u); e tenendo presente che la base <span class="math"><em>B</em><sub><em>i</em></sub></span> e non nulla solo su <span class="math">[<em>u</em><sub><em>i</em></sub>, <em>u</em><sub><em>i</em> + <em>d</em></sub>[</span>, allora nell’inter-vallo <span class="math">[<em>u</em><sub><em>i</em></sub>, <em>u</em><sub><em>i</em> + 1</sub>[</span> intervengono solo un numero finito, pari a <span class="math"><em>d</em></span>, di basi <sub>i</sub>(u) &amp; = &amp; <sub>j=0</sub><sup>3</sup><span><strong>x</strong></span><sub>i-j</sub>B<sub>i-j</sub>(u)=<br />&amp; &amp;<br />&amp; = &amp; <span><strong>x</strong></span><sub>i</sub>B<sub>i</sub>(u)+<span><strong>x</strong></span><sub>i-1</sub>B<sub>i-1</sub>(u)+ <span><strong>x</strong></span><sub>i-2</sub>B<sub>i-2</sub>(u)+<span><strong>x</strong></span><sub>i-3</sub>B<sub>i-3</sub>(u)</p>
<p>Inoltre, limitatamente all’intervallo considerato, la <span class="math"><em>B</em><sub><em>i</em></sub></span> contribuisce con il tratto di polinomio <span class="math"><em>b</em><sub><em>i</em></sub></span> per cui l’espressione si semplifica ulteriormente nella <sub>i</sub>(s) &amp; = &amp; <sub>j=0</sub><sup>3</sup><span><strong>x</strong></span><sub>i-j</sub>b<sub>j</sub>(s)=<br />&amp; &amp;<br />&amp; = &amp; <span><strong>x</strong></span><sub>i</sub>b<sub>0</sub>(s)+<span><strong>x</strong></span><sub>i-1</sub>b<sub>1</sub>(s)+ <span><strong>x</strong></span><sub>i-2</sub>b<sub>2</sub>(s)+<span><strong>x</strong></span><sub>i-3</sub>b<sub>3</sub>(s) per ogni quaterna <span class="math">$[\,{\bf x}_i,{\bf x}_{i-1},{\bf x}_{i-2},{\bf x}_{i-3}\,]$</span> di <span><em>control points</em></span>.</p>
<p>Il vantaggio di quest’ultima espressione che puøessere convenientemente espressa in forma matriciale. Riordinando i termini della () nella forma <sub>i</sub>(s)=<span><strong>x</strong></span><sub>i-3</sub>b<sub>3</sub>(s)+<span><strong>x</strong></span><sub>i-2</sub>b<sub>2</sub>(s)+ <span><strong>x</strong></span><sub>i-1</sub>b<sub>1</sub>(s)+<span><strong>x</strong></span><sub>i</sub>b<sub>0</sub>(s) la si puøscrivere come prodotto di vettori <sub>i</sub>(s)=<span><strong>b</strong></span>(s)<span><strong>x</strong></span><sub>i</sub>= . Espandendo i termini <span class="math"><em>b</em><sub><em>j</em></sub></span> il primo vettore risulta (s)=<span><strong>s</strong></span><sup>T</sup><span><strong>M</strong></span>= e quindi concludendo</p>
<p><sub>i</sub>(s)=<span><strong>s</strong></span><sup>T</sup><span><strong>M</strong></span><span><strong>x</strong></span><sub>i</sub></p>
<p></p>
<h2 id="alcune-proprietdelle-b-splines">Alcune proprietdelle B-splines</h2>
<h3 id="convex-hull">Convex hull</h3>
<p></p>
<p>In figura () rappresentato la <span><em>convex hull</em></span> dell’insieme <span class="math"><em>Q</em></span> dei <span><em>control points</em></span> definita come il pipiccolo poligono convesso tale per cui tutti i punti di <span class="math"><em>Q</em></span> o sono interni o al piăppartengono al bordo.</p>
<p>(5)</p>
<p>Dalla definizione di insieme convesso</p>
<p>Si dice che un sottoinsieme <span class="math"><em>A</em></span> di uno spazio vettoriale convesso quando verifica la condizione: <span><strong>x</strong></span><sub>1</sub>+(1-)(<span><strong>x</strong></span><sub>2</sub>-<span><strong>x</strong></span><sub>1</sub>)A <span><strong>x</strong></span><sub>1</sub>,<span><strong>x</strong></span><sub>2</sub>A (Nel nostro caso lo spazio considerato <span class="math">$\M(R)^2$</span> e l’insieme <span class="math"><em>A</em></span> la convex hull).</p>
<p>possibile ricavare la condizione che caratterizza la convex hull in funzione dei control points, ovvero</p>
<p>Ciascun punto <span><strong>p</strong></span> della convex hull puøessere espresso come combinazione lineare convessa dei control points <span class="math">$[{\bf x}_0,\dots,{\bf x}_{m-1}]$</span> =<sub>i=0</sub><sup>m-1</sup>w<sub>i</sub><span><strong>x</strong></span><sub>i</sub> ,w<sub>i</sub> 0i e <sub>i=0</sub><sup>m-1</sup>w<sub>i</sub>=1</p>
<p>Si consideri lo span definito dai control points <span class="math">$[{\bf x}_0,{\bf x}_1,{\bf x}_2,{\bf x}_3]$</span> di Figura ; questi risulta contenuto nella convex hull definita dai suoi <span class="math">4</span> control points nell’ordine, antiorario, <span class="math">$\{{\bf x}_0,{\bf x}_2,{\bf x}_3,{\bf x}_1\}$</span>. Infatti vale la proposizione precedente in quanto si verifica dalle () che <sub>j=0</sub><sup>3</sup>b<sub>j</sub>(s)=1 s [0,1[ ed inoltre <span class="math"><em>b</em><sub><em>j</em></sub>(<em>s</em>)</span> non negativa, quindi i nostri <span class="math"><em>w</em><sub><em>i</em></sub></span> sono proprio i <span class="math"><em>b</em><sub><em>j</em></sub></span>.</p>
<p>In base a questi risultati, noto il poligono dei control points, possibile conoscere lo spazio in cui si trova la curva a B-splines. In particolare la B-spline approssima in modo regolare le variazioni del poligono dei control points.</p>
<h3 id="invarianza-alle-traslazioni">Invarianza alle traslazioni</h3>
<p>Con tale proprietsi vuole indicare che anche se i <span><em>control points</em></span> <span class="math">${\bf x}_i$</span> vengono traslati della stessa quntit<span class="math">${\bf v}$</span> la nuova curva descritta <span class="math">${\bf r_v}$</span> ottenuta applicando la stessa traslazione a tutti i punti della curva originaria <span class="math">${\bf r}$</span>.</p>
<p>(u)=<sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)(<span><strong>x</strong></span><sub>i</sub>+<span><strong>v</strong></span>)= <sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)<span><strong>x</strong></span><sub>i</sub>+ <span><strong>v</strong></span><sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)</p>
<p>Per la proprietprecedente () la seconda sommatoria pari a <span class="math">1</span> per cui risulta (u)=<sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)<span><strong>x</strong></span><sub>i</sub>+<span><strong>v</strong></span>= <span><strong>r</strong></span>(u)+<span><strong>v</strong></span> u</p>
<h3 id="invarianza-alle-rotazioni-e-alle-omotetie">Invarianza alle rotazioni e alle omotetie</h3>
<p></p>
<p>E’ possibile verificare la stessa invarianza sia per le rotazioni sia per le omotetie (dilatazioni o contrazioni).</p>
<p>. La rotazione di un angolo <span class="math"><em>θ</em></span> ()= (u)=<sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)<span><strong>R()</strong></span><span><strong>x</strong></span><sub>i</sub>= <span><strong>R()</strong></span><sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)<span><strong>x</strong></span><sub>i</sub>= <span><strong>R()</strong></span><span><strong>r</strong></span>(u)</p>
<p>. Si considera in particolare il cambiamento di scala di fattore <span class="math"><em>γ</em></span> definito rispetto al centroide <span class="math">${\bf c}$</span> dei punti di controllo come in Figura (u) &amp; = &amp; <sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)[(<span><strong>x</strong></span><sub>i</sub>-<span><strong>c</strong></span>)+<span><strong>c</strong></span>]<br />&amp; = &amp; <sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)<span><strong>x</strong></span><sub>i</sub>+ (1-)<span><strong>c</strong></span><sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)=<br />&amp; = &amp; <span><strong>r</strong></span>(u)+(1-)<span><strong>c</strong></span> in quanto la seconda sommatoria pari a <span class="math">1</span> per la proprietdi <span><em>convex hull</em></span> definita precedentemente, e dove =<sub>i=0</sub><sup>m-1</sup><span><strong>x</strong></span><sub>i</sub> La trasformazione esposta puøessere espressa in una forma picompatta come prodotto di matrici (a tal proposito si veda l’Appendice ).</p>
<h2 id="condizioni-per-gli-estremi-delle-curve-a-b-splines">Condizioni per gli estremi delle curve a B-splines</h2>
<p>Considerando la Figura si puønotare che gli estremi della curva, composta di due spans, non sono vincolati a dei punti particolari, ma le loro coordinate sono comunque note valutando la () per <span class="math"><em>s</em> = 0</span> e <span class="math"><em>s</em> = 1</span> con le rispettive quaterne di control points. In generale quindi se <span class="math">$[{\bf x}_0,\dots,{\bf x}_{m-1}]$</span> il vettore dei control points le coordinate dei punti di “inizio” <span class="math">${\bf p}_s$</span> e di “fine” <span class="math">${\bf p}_e$</span> della curva risultano <sub>s</sub> &amp; = &amp; <span><strong>r</strong></span><sub>3</sub>(0)=<br />&amp; &amp;<br /><span><strong>p</strong></span><sub>e</sub> &amp; = &amp; <span><strong>r</strong></span><sub>m-1</sub>(1)=</p>
<p>Per ottenere un comportamento diverso per gli estremi, quale puøessere la condizione che li vuole coincidenti con il primo e l’ultimo control points, si puøprocedere in due modi: nel caso particolare delle B-splines uniformi si realizzano i <span><em>multiple vertices</em></span> ottenuti raddoppiando o triplicando i due vertici estremi; oppure inserendo altri punti di controllo noti come <span><em>phantom vertices</em></span> (<span class="citation" data-cites="Bartels"></span>) un’altra soluzione quella di prevedere per gli estremi delle basi differenti (si parla in tal caso di B-splines <span><em>aperiodiche</em></span>) ottenute moltiplicando i <span><em>nodi</em></span> e non i punti di controllo. In questo modo si riducono i vincoli sulla regolaritdella base e quindi possibile utilizzare i gradi di liber-tin piper condizionare la posizione degli estremi, senza introdurre altri control points (<span class="citation" data-cites="BlakeAC"></span>).</p>
<h3 id="curve-a-b-splines-chiuse">Curve a B-splines chiuse</h3>
<p>Un caso particolarmente interessante per l’applicazione considerata in queta tesi dato dalle a curve a B-splines chiuse, ovvero in cui i due punti <span class="math">${\bf p}_s$</span> e <span class="math">${\bf p}_e$</span> coincidono (si veda la Figura ). E’ realizzata semplicemente ponendo uguali i primi e gli ultimi <span class="math">3</span> <span><em>control points</em></span>, ovvero assegnato il vettore <span class="math">${\bf X}=[{\bf x}_0,\dots,{\bf x}_{m-1}]$</span> si considera il nuovo vettore <span class="math">$\hat{\bf X}=[{\bf x}_0,\dots,{\bf x}_{m-1},{\bf x}_0,{\bf x}_1,{\bf x}_2,]$</span>.</p>
<h2 id="punti-singolari-delle-curve-a-b-splines">Punti singolari delle curve a B-splines</h2>
<p>Le osservazioni fatte precedentemente sui vincoli per gli estremi delle curve a B-spline valgono anche nel momento in cui si conceda che la curva abbia delle singolaritnelle derivate, per cui non risulta piu<span class="math"><em>C</em><sup>(<em>d</em> − 2)</sup></span>, come nel caso tipico di punti angolosi o <span><em>hinge</em></span>.</p>
<p>Nel caso delle B-spline uniformi ciøpuøessere ottenuto in due modi: con l’inserimento di control points interni multipli, oppure, piŏpportunamente, introducendo la singolaritnelle basi delle B-splines.</p>
<p>(5)</p>
<p>Per ulteriori considerazioni si rimanda ai riferimenti <span class="citation" data-cites="BlakeAC"></span>, <span class="citation" data-cites="Bartels"></span> in cui possibile trovare anche gli algoritmi per il calcolo ricorsivo delle basi nel caso piğenerale.</p>
<h1 id="contorni-attivi">Contorni attivi</h1>
<p>Nel Capitolo si accennato all’utilizzo di alcuni operatori locali che permettono di individuare nell’immagine delle opportune primitive (<span><em>features</em></span>) il cui insieme costituisce una nuova immagine o mappa delle primitive (<span><em>features map</em></span>) la cui interpretazione puøpermettere di individuare gli elementi (oggetti) che compongono l’immagine.</p>
<p>Il problema che, tranne in casi molto fortunati in cui si hanno immagini costituite da elementi distinti, prive di particolari disturbi e con superfici dei materiali ripresi sostanzialmente uniformi, vi possono essere diverse false <span><em>features</em></span>. Occorre pertanto definire un criterio che permetta di estrarre solo quelle vere. Nel caso pisemplice si puøconsiderare una funzione costante che coincide con un valore di soglia, valore che perøpuønon essere semplice individuare e che inoltre puøgenerare il problema opposto, ovvero portare ad eliminare anche alcune <span><em>features</em></span> buone che perøsono “deboli”, per cui si ottiene una descrizione frammentaria della <span><em>features map</em></span> dell’immagine che ne complica la successiva elaborazione.</p>
<p>Come giaccennato precedentemente, una soluzione di notevole interesse data dagli <span><em>active contours</em></span>, chiamati comunemente <span><em>snakes</em></span><span class="citation" data-cites="Kass"></span>.</p>
<p>.</p>
<h2 id="snakes">Snakes</h2>
<p>Con <span><em>snake</em></span> si intende una curva deformabile <span class="math">${\bf r}(s)$</span>, <span class="math">0 ≤ <em>s</em> ≤ 1</span>, che sotto l’azione di opportune “forze” definite nello spazio delle primitive dell’immagine tende a deformarsi in modo da minimizzare una “energia” o “funzione costo”. Nel caso particolare della soluzione di problemi di segmentazione tale funzione definita in modo che la condizione di minimo porti la curva ad adagiarsi lungo i contorni degli oggetti, per cui lo spazio delle primitive dato generalmente dalla mappa degli <span><em>edgles</em></span>.</p>
<p>Determinare la mappa delle features completa puørichiedere tempi eccessivi per l’applicazione considereta, ed inoltre non detto sia necessario; per cui tali primitive possono essere individuate limitatamente all’intorno della curva analizzando l’immagine lungo direzioni particolari, tipicamente lungo la normale alla curva <span class="citation" data-cites="BlakeAC"></span>.</p>
<p>L’energia totale <span class="math">${\cal E}({\bf r})$</span>, lungo tutta la curva, che individua lo stato dello snake composta di due termini (<span><strong>r</strong></span>)=<span>E</span><sub>s</sub>(<span><strong>r</strong></span>)+<span>P</span>(<span><strong>r</strong></span>). Il primo rappresenta l’<span><em>energia interna</em></span> che controlla la regolaritdella curva e quindi un vincolo sulla classe delle forme che puøsegmentare: <sub>s</sub>(<span><strong>r</strong></span>)=<sub>0</sub><sup>1</sup>w<sub>1</sub>(s)|<span><strong>r</strong></span><sub>s</sub>|<sup>2</sup>+ w<sub>2</sub>(s)|<span><strong>r</strong></span><sub>ss</sub>|<sup>2</sup>ds,()</p>
<p>dove <span class="math"><em>w</em><sub>1</sub>(<em>s</em>)</span> controlla l’“elasticit” rispetto alle sollecitazioni che tendono a dilatare o comprimere lo snake (trazione e compressione) e <span class="math"><em>w</em><sub>2</sub>(<em>s</em>)</span> la “rigidezza” rispetto alle deformazioni trasversali allo snake (flessione).</p>
<p>Infatti se si aumentasse solo <span class="math"><em>w</em><sub>1</sub>(<em>s</em>)</span>, minimizzare l’energia corrisponderebbe ad accorciare la lunghezza della curva fino, caso limite, a ridurla ad un punto; nel caso di <span class="math"><em>w</em><sub>2</sub>(<em>s</em>)</span> invece si avrebbe la tendenza ad aumentare la regolaritdella curva fino ad approssimare una linea retta. Al contrario riducendo i due termini, al limite ponendoli a zero, possibile ottenere una curva che presenti dei punti angolosi o addidrittura delle discontinuit.</p>
<p>Il secondo termine della () rappresenta l’<span><em>energia potenziale</em></span> dello <span><em>snake</em></span> rispetto allo spazio delle primitive; per cui se <span class="math">$\cal P$</span> definita in modo tale che i suoi punti di minimo siano in corrispondenza delle <span><em>features</em></span>, allora la minimizzazione della () spinge lo snake ad approssimarle. L’energia potenziale lungo tutta la curva puøessere definita come l’integrale curvilineo di una funzione potenziale (<span><strong>r</strong></span>)=<sub>0</sub><sup>1</sup>P(<span><strong>r</strong></span>(s))ds dove <span class="math">$P({\bf r})$</span> una funzione che mappa i punti dell’immagine nello spazio delle primitive. Alcuni esempi tipici delle definizioni di <span class="math">$P({\bf r})$</span> sono <span class="math">$P({\bf r})\,=\,\pm\,c\,\bigg(\,G_\sigma \ast I\,({\bf r})\,\bigg)$</span> se si considera come primitiva i picchi di intensit: bassa o alta intensit, chiaro o scuro, a seconda del segno; <span class="math">$P({\bf r})\,=\,-\,c\,\Big|\,\nabla\bigg(\,G_\sigma \ast I\,({\bf r})\,\bigg)\,\Big|$</span> in questo caso si considerano gli <span><em>edgels</em></span>. Per entrambi i casi si sono considerati solo i punti della curva, <span class="math">${\bf r}(s)$</span>, in base all’osservazione .</p>
<p>Come accennato nel caso degli <span><em>edge-detector</em></span>, l’azione della convoluzione con la gaussiana <span class="math"><em>G</em><sub><em>σ</em></sub>(<em>x</em>, <em>y</em>)</span> rivolto sia alla riduzione dell’<span class="math"><em>S</em><em>N</em><em>R</em></span> all’uscita del filtro <span class="math"><em>P</em>(<em>x</em>, <em>y</em>)</span> sia a migliorare il grado di localizzazione degli <span><em>edgels</em></span>. Nel caso degli <span><em>snakes</em></span> questo puøessere visto come una trasformazione della superficie su cui esso si muove, l’immagine, che possa da un lato facilitare l’avvicinamento ai punti del contorno (<span class="math"><em>σ</em></span> grande) e dall’altro fare in modo che l’errore di approssimazione ammesso (in termini di localizzazione del bordo) sia piccolo (<span class="math"><em>σ</em></span> piccola). Anche in questo caso le due condizioni lavorano in direzioni opposte, per cui risulta non sempre facile fissare un valore per tutte le zone dell’immagine; eventualmente si potrebbe considerare <span class="math"><em>σ</em></span> variabile in base alle caratteristiche locali dell’immagine stessa come nel caso degli operatori anisotropi.</p>
<h2 id="un-approccio-lagrangiano">Un approccio Lagrangiano</h2>
<p>La soluzione al problema della minimizzazione dell’energia <span class="math">$\cal E$</span> puøessere determinata in modo statico calcolando direttamente i punti di estremo; in realt, anche in considerazione del modo in cui vengono determinate le primitive, conveniente considerare lo <span><em>snake</em></span> come una curva che si muove sul piano immagine (<span><em>dynamic snake</em></span>) la cui posizione e forma variano ad ogni passo in relazione alle misure effettuate; ne deriva che la condizione di minimo dell’energia coincide perciøcon lo stato di equilibrio del sistema dinamico.</p>
<p>Il nuovo modello ottenuto ridefinendo la carta <span class="math">${\bf r}(s,t)$</span> per tener conto della variazione nel tempo <span class="math"><em>t</em></span> e considerando che la curva abbia una densitdi massa <span class="math"><em>μ</em>(<em>s</em>)</span>, per cui presente anche una componente di energia cinetica (<span><strong>r</strong></span>)=<sub>0</sub><sup>1</sup>(s)|<span><strong>r</strong></span><sub>t</sub>|<sup>2</sup>ds A causa dell’inerzia introdotta da <span class="math"><em>μ</em>(<em>s</em>)</span>, affinché il sistema raggiunga uno stato stabile necessario introdurre un termine a cui sia affidata la dissipazione dell’energia cinetica immagazzinata. A tal scopo si puøconsiderare la funzione <span><em>dissipazione di Rayleigh</em></span> definita (<span><strong>r</strong></span><sub>t</sub>)=<sub>0</sub><sup>1</sup>|<span><strong>r</strong></span><sub>t</sub>|<sup>2</sup>ds. Applicando il <span><em>principio di Hamilton</em></span> si perviene alle <span><em>equazioni di Lagrange</em></span> <span class="citation" data-cites="BlakeAV1"></span> <sub>tt</sub>+<sub>t</sub>-(w<sub>1</sub><span><strong>r</strong></span><sub>s</sub>)+ (w<sub>2</sub><span><strong>r</strong></span><sub>ss</sub>)=-P(<span><strong>r</strong></span>(s,t)) in cui si sono considerate <span class="math"><em>μ</em>(<em>s</em>) = <em>μ</em></span> e <span class="math"><em>γ</em>(<em>s</em>) = <em>γ</em></span> costanti lungo tutta la curva.</p>
<h4 id="kalman-snakes">Kalman-snakes</h4>
<p>Tenendo conto della dinamica dello snake possibile risolvere problemi picomplessi in cui la mappa delle <span><em>features</em></span> varia nel tempo a cusa del moto relativo tra il sensore e l’oggetto da inseguire: si parla perciødi <span><em>data tracking</em></span>. In questo caso l’equilibrio raggiunto dinamico in quanto lo snake tende ad approssimare dei dati che non sono costanti nel tempo. Le prestazioni del sistema migliorano sensibilmente se si integrano nel tempo le misure delle primitive con il modello dinamico dello snake utilizzando il <span><em>filtro di Kalman</em></span>, il cui passo di predizione permette di stabilire come potressere l’evoluzione dello snake al passo successivo individuando la regione di confidenza entro cui sarprobabile trovarlo nell’immagine succesiva. La posizione reale verrindividuata dalle misure effettuate nel passo di aggiornamento.</p>
<p>L’introduzione del filtro, il cui peso computazionale generalmente trascurabile, permette di ridurre la regione dell’immagine su cui effettuare le misure, che la componente critica per la quantitdi dati considerati, e quindi migliorare l’efficienza generale dell’algoritmo.</p>
<h2 id="contorni-dinamici">Contorni dinamici</h2>
<p>Nel modello utilizzato finora gli unici vincoli sulle deformazioni a cui soggetto lo snake sono dati dai termini di energia interna associati ai coefficienti <span class="math"><em>w</em><sub>1</sub>(<em>s</em>)</span> e <span class="math"><em>w</em><sub>2</sub>(<em>s</em>)</span>.</p>
<p>Esiste la possibilitdi vincolare la curva in modo che assuma delle forme che si discostino relativamente da un modello prefissato (<span><em>template</em></span>). La curva quindi definita da una carta <span class="math">${\bf r}(s;{\bf X})$</span> <span class="citation" data-cites="BlakeAC"></span> che funzione di un vettore di parametri che tengono conto delle possibili trasformazioni che questa puøsubire (rotazioni, traslazioni, dilatazioni, etc.); ovvero a partire da una forma di riferimento si applicano le trasformazioni, scelte fra quelle accettabili, che permettono di sovrapporla all’oggetto corrispondente che si trova sul piano immagine: si parla perciødi <span><em>deformable templates</em></span>.</p>
<p>Considerando quindi il modello dinamico definito dai <span><em>Kalman snakes</em></span> proiettato nello spazio delle forme (<span><em>deformable templates</em></span>) si ottengono i <span><strong>contorni dinamici</strong></span> o <span><strong>dynamic contours</strong></span>.</p>
<h2 id="discretizzazione-dello-snake">Discretizzazione dello snake</h2>
<p>Le soluzioni dell’equazione () sono curve continue nello spazio <span class="math">$\M(R)^2$</span>, mentre per poterle elaborare numericamente necessario discretizzarle. Il modo pisemplice dato dal campionamento della curva con un passo di campionamento <span class="math"><em>h</em> = 1 / (<em>N</em> − 1)</span> nello spazio del parametro <span class="math"><em>s</em> ∈ [0, 1]</span> per cui i campioni della curva sono <span class="math">${\bf r}(i\,h)$</span> con <span class="math"><em>i</em> = 1, …, <em>N</em></span>. L’equazione differenziale si trasforma perciøin un’equazione alle differenze sostituendo le derivate prima e seconda con le espressioni <sub>s</sub>(s<sub>i</sub>)= e <sub>ss</sub>(s<sub>i</sub>)= Analogamente per le derivate rispetto la variabile temporale <span class="math"><em>t</em></span>.</p>
<p>L’equazione di Lagrange () viene espressa da una equazione differenziale del secondo ordine <span class="citation" data-cites="BlakeAV1"></span> +<span><strong>C</strong></span>+<span><strong>Ku</strong></span>=<span><strong>f</strong></span> con ={<span><strong>u</strong></span><sub>i</sub>}<sub>i=1,…,N</sub>=<span><strong>r</strong></span>(ih) dove <span class="math">${\bf M}$</span> la matrice delle masse, <span class="math">${\bf C}$</span> tiene conto dei fenomeni di dissipazione, <span class="math">${\bf K}$</span> della rigidezza dello snake e <span class="math">${\bf f}$</span> dipende da <span class="math">∇<em>P</em></span>.</p>
<p>Effetto del campionamento della curva la perdita della proprietdi continuite quindi dell’informazione sulla forma individuata dallo <span><em>snake</em></span> stesso, per cui, sia nel caso particolarmente interessante dei contorni dinamici accennati precedentemente sia nel caso dei semplici <span><em>snake</em></span> nella forma data dall’equazione (), si ricorre ad approssimazioni con metodi agli “<span><em>elementi finiti</em></span>” in cui la curva <span class="math">${\bf r}$</span> definita dalla combinazione lineare di particolari funzioni <span class="math"><em>B</em><sub><em>i</em></sub></span>, elementi della base di un opportuno spazio vettoriale, pesate dai <span><em>nodi</em></span> <span class="math">${\bf q_i}(t)$</span> (s,t)=<sub>i=1</sub><sup>N</sup>B<sub>i</sub>(s)<span><strong>q</strong></span><sub>i</sub>(t) Un modello particolarmente interessante, che sarconsiderato nel nostro caso, dato dall’approssimazione a <span><strong>splines</strong></span> in cui la curva approssimata da funzioni polinomiali a tratti parametrizzate dai nodi <span class="math">${\bf q_i}(t)$</span> che prendono il nome di <span><em>control points</em></span> <span class="citation" data-cites="BlakeAV2"></span> .</p>
<h2 id="un-approccio-statistico">Un approccio statistico</h2>
<p>L’introduzione degli <span><em>snakes</em></span> ha permesso di risolvere alcuni problemi che affliggono i metodi di segmentazione che si basano sulla sola <span><em>edge-detection</em></span> fornendo un modello che permette di mantenere le informazioni sulla forma degli oggetti a cui appartengono gli <span><em>edgels</em></span>.</p>
<p>Si quindi posto il problema come la minimizzazione di una particolare funzione energia, dove il termine legato all’immagine definito da un potenziale, che minimo in corrispondenza dei bordi dei segmenti.</p>
<p>Finora si considerato il potenziale definito in funzione delle proprietlocali nell’intorno della curva (<span><em>feautures</em></span>) e in particolare considerando il gradiente dell’immagine opportunamente filtrata; ma, a causa dell’operatore differenziale, tali misure sono molto sensibili ai disturbi di diversa natura che possono essere presenti nell’immagine stessa, ovvero tale sensibilitpuøessere ridotta con un aumento dell’azione filtrante ma a scapito della capacitdi localizzazione.</p>
<p>Per ovviare a tale limite sono state proposte soluzioni alternative che tengono conto anche delle proprietdi omogeneita dei segmenti. Si possono individuare due strade: si identificano i bordi in modo indiretto, senza utilizzare operatori differenziali, ridefinendo un’opportuna energia che tenga conto anche della statistica dei segmenti e forzando i contorni attivi a disporsi in modo da massimizzare la differenza fra i segmenti separati dai contorni stessi <span class="citation" data-cites="Yezzi"></span>, <span class="citation" data-cites="Yuille"></span>; considerando i due approcci distinti che interagiscono fra di loro in base ad opportune regole <span class="citation" data-cites="Duncan"></span> che stabiliscono come il risultato di uno venga valutato dall’altro e quindi la possibile contromossa piconveniente in termini di “costo”, fino a giungere ad una condizione di equilibrio.</p>
<h3 id="lalgoritmo-di-yezzi-tsai-e-willsky">L’algoritmo di Yezzi, Tsai e Willsky</h3>
<p>Nell’ambito delle soluzioni del primo tipo vi l’algoritmo proposto da A. Yezzi, A. Tsai e A. Willsky in <span class="citation" data-cites="Yezzi"></span> che permette di incorporare in un nuovo modello di <span><em>snake</em></span> sia informazioni locali sia globali attraverso una funzione energia diversa da quelle considerate finora. Il vincolo principale nell’utilizza-re il modello proposto che siano note a priori come le primitive scelte per la segmentazione descrivono i diversi elementi dell’insieme da segmentare, per cui ad ogni oggetto sia associabile un valore per ogni feature. Il valore non deve essere necessariamente noto ma ,se esiste, si deve poter dire che allora esso contraddistingue quell’oggetto rispetto agli altri. Per esempio si possono avere diversi oggetti che sono contraddistinti da colori diversi, da tessitura diversa, etc. Anche se i colori non sono noti si sa che comunque sono differenti.</p>
<p>In particolare si considera l’algoritmo nel caso di immagini bimodali o binarie, ciocostituite da due regioni (<span><em>foreground</em></span> e <span><em>background</em></span>) rispetto alla primitiva considerata: il <span><em>colore</em></span>.</p>
<p>Sia <span class="math"><em>I</em>(<em>x</em>, <em>y</em>)</span> l’immagine e <span class="math"><em>F</em> ∈ <em>I</em></span> (<span><em>foreground</em></span>) la regione obiettivo della segmentazione, per cui <span class="math"><em>B</em> = <em>F</em><sup><em>c</em></sup></span> (<span><em>background</em></span>) il suo complementare; lo scopo quindi deformare la <span><em>curva chiusa</em></span> iniziale <span class="math">Γ (<em>t</em>)</span> definita su <span class="math"><em>I</em></span> in modo che tenda ad abbracciare la regione <span class="math"><em>F</em></span> e quindi coincida con il bordo <span class="math">∂<em>F</em></span>.</p>
<p>Definiamo <span class="math"><em>P</em></span> la funzione <span class="math"><em>N</em></span> dimensionale che definisce il vettore di primitive scelta fra quelle che meglio discriminano le due regioni; si considerino quindi le medie <span class="math"><em>m</em><sup><em>i</em><em>n</em><em>t</em></sup></span> e <span class="math"><em>m</em><sup><em>e</em><em>s</em><em>t</em></sup></span> dei valori di <span class="math"><em>P</em></span> nelle due regioni rispettivamente interna <span class="math"><em>R</em><sup><em>i</em><em>n</em><em>t</em></sup></span> ed esterna <span class="math"><em>R</em><sup><em>e</em><em>s</em><em>t</em></sup></span> rispetto alla curva: m<sub>j</sub><sup>int</sup>()= j=1,…,N () <br /><span class="math">$$S_j^{int}\,=\,{\ds\int_{R^{int}}}\,P_j({\bf x})\,d{\bf x} \qquad\qquad
A^{int}\,=\,{\ds\int_{R^{int}}}\,d{\bf x}$$</span><br /></p>
<p>Analogamente per <span class="math"><em>m</em><sub><em>e</em></sub>(Γ )</span>.</p>
<p>La nuova funzione energia definita in funzione della distanza fra <span class="math"><em>m</em><sup><em>i</em><em>n</em><em>t</em></sup></span> e <span class="math"><em>m</em><sup><em>e</em><em>s</em><em>t</em></sup></span> =-m<sup>int</sup>-m<sup>est2</sup></p>
<p><span><em>in cui si considerata la norma in quanto in generale <span class="math"><em>P</em></span> una funzione vettoriale; questo molto importante perchpermette di combinare in modo semplice caratteristiche dell’immagine diverse tra loro</em></span>.</p>
<p>Tale energia minima quando la differenza fra le due medie massima, ovvero quando la curva coincide col bordo.</p>
<p>La curva iniziale potressere prossima al bordo di <span class="math"><em>F</em></span> ma non coincidere e quindi o intersecare le due regioni o essere contenuta in una delle due regioni, per cui la distanza fra i due vettori di media sarinferiore al valore finale.</p>
<p>L’evoluzione della curva puøessere ricavata considerando &amp; = &amp; - ()<br />&amp; = &amp; <sub>j=1</sub><sup>N</sup>(m<sub>j</sub><sup>int</sup>-m<sub>j</sub><sup>est</sup>)</p>
<p>dove dalla definizione data per <span class="math"><em>m</em><sup><em>i</em><em>n</em><em>t</em></sup></span> e <span class="math"><em>m</em><sup><em>e</em><em>s</em><em>t</em></sup></span> nella () si ricava m<sub>j</sub><sup>int</sup> &amp; = &amp; =<br />m<sub>j</sub><sup>est</sup> &amp; = &amp; con S<sub>j</sub><sup>int</sup>=P<sub>j</sub><span><strong>n</strong></span> A<sup>int</sup>=<span><strong>n</strong></span> in cui <span><strong>n</strong></span> la normale esterna alla curva <span class="math">Γ </span> (si veda l’Appendice ).</p>
<p>Allora risulta m<sub>j</sub><sup>int</sup> &amp; = &amp; <span><strong>n</strong></span><br />m<sub>j</sub><sup>est</sup> &amp; = &amp; -<span><strong>n</strong></span> Il segno meno nell’ultima equazione deriva dal fatto che la normale esterna alla curva vista rispetto <span class="math"><em>R</em><sup><em>i</em><em>n</em><em>t</em></sup></span> la normale interna rispetto <span class="math"><em>R</em><sup><em>e</em><em>s</em><em>t</em></sup></span>.</p>
<p>Quindi riassumendo =<sub>j=1</sub><sup>N</sup>(m<sub>j</sub><sup>int</sup>-m<sub>j</sub><sup>est</sup>)</p>
<p>Data la definizione (), nel caso particolare di una sola regione <span class="math"><em>F</em></span> connessa, l’energia <span class="math">${\cal E}$</span> puøassumere un solo valore di minimo e un certo numero di massimi che coincidono con <span class="math">${\cal E}=0$</span> e che corrisponde a <span class="math"><em>m</em><sup><em>i</em><em>n</em><em>t</em></sup> = <em>m</em><sup><em>e</em><em>s</em><em>t</em></sup> = (<em>P</em>(<em>F</em>) + <em>P</em>(<em>B</em>)) / 2</span> e che si verifica se la <span><em>curva iniziale</em></span> tale per cui suddivide le due regioni <span class="math"><em>F</em></span> e <span class="math"><em>B</em></span> in due parti con aree uguali. Dalla () si conclude che questa condizione non permette l’evoluzione dello snake che rimane nella configurazione iniziale; per evitare una tale situazione si puøverificare all’inizio dell’evoluzione se <span class="math"><em>m</em><sup><em>i</em><em>n</em><em>t</em></sup> = <em>m</em><sup><em>e</em><em>s</em><em>t</em></sup></span> ed eventualmente introdurre una qualsiasi perturbazione su <span class="math">Γ </span>.</p>
<h1 id="architettura-dellalgoritmo-di-segmentazione">Architettura dell’algoritmo di segmentazione</h1>
<p>In questo capitolo presentato l’algoritmo di segmentazione sviluppato che permette di individuare la macchia attraverso una descrizione compatta del suo contorno, in vista delle successive misure di dimensioni, forma, simmetrie, etc.</p>
<h4 id="la-struttura-dellalgoritmo">La struttura dell’algoritmo</h4>
<p>L’algoritmo composto di due blocchi principali</p>
<h2 id="algoritmo-fase-1">Algoritmo: Fase 1</h2>
<p>In questa prima fase l’immagine viene elaborata in modo da migliorare la qualitdella primitiva che si considera ai fini della segmentazione (nel nostro caso il colore) eliminando gli elementi di disturbo che possono compromettere la localizzazione dei contorni che in questa applicazione sono soprattutto i peli i quali possono intersecare la macchia o peggio essere vicini al contorno tanto da coprirlo. Rientra in questa fase anche il problema dell’inizializzazione del controrno attivo che poi evolverfino a descrivere l’oggetto della segmentazione: la macchia cutanea.</p>
<h3 id="condizionamento-dellimmagine">Condizionamento dell’immagine</h3>
<p>Nel Capitolo si sono introdotte alcune rappresentazioni dello spazio dei colori che presentano delle proprietche le rendono preferibili al modello <span class="math"><em>R</em><em>G</em><em>B</em></span> come lo spazio <span class="math"><em>H</em><em>S</em><em>I</em></span> (o <span class="math"><em>H</em><em>S</em><em>V</em></span>) e la <span><em>trasformata di Karhunen-Loève</em></span> (o di <span><em>Hotelling</em></span>). Vista la natura del problema, per cui si considera un solo elemento connesso e uniforme (rispetto al colore) circondato da una zona anch’essa uniforme, sembrerebbe sufficiente considerare la componente di <span class="math"><em>H</em><em>u</em><em>e</em></span>. La sola tonalitperøsoddisfacente nel caso in cui si abbia una illuminazione sufficientemente uniforme e non vi siano eccessivi effetti di riflessione. Risultati migliori si ottengono invece elaborando le componenti della <span><em>trasformata di Karhunen-Loève</em></span> <span class="citation" data-cites="Lucchese"></span> <span class="citation" data-cites="Schmid"></span>.</p>
<h4 id="attenuazione-degli-elementi-di-disturbo">Attenuazione degli elementi di disturbo</h4>
<p>Utilizzzando quest’ultima trasformata possibile predisporre una strategia per eliminare alcuni disturbi presenti quali i peli, che generalmente appaiono come strutture con una elevata correlazione lungo una direzione e il cui spessore non sempre trascurabile in relazione alle dimensioni della macchia.</p>
<p>Si puøutilizzare un filtro passa-basso, ad esempio gaussiano, o un filtro a mediana che rispetto al precedente permette di ottenere un’immagine con una maggior definizione dei contrasti.</p>
<p>Ma a causa delle dimensioni trasversali dei peli e del fatto che non nota la direzione lungo la quale si sviluppano anche nel secondo caso necessario considerare per il filtro una finestra <span class="math"><em>n</em> × <em>n</em></span> di pixels abbastanza grande (<span class="math"><em>n</em></span> dell’ordine di <span class="math">10 ÷ 15</span>) con dei risultati comunque non soddisfacenti (Figura ).</p>
<p>Altre soluzioni picomplesse considerano l’impiego degli operatori morfologici <span class="citation" data-cites="Schmid"></span> combinando opportunamente le operazioni di chiusura e apertura (vedi Capitolo ) con un’opportuna scelta del nucleo (o <span><em>structuring element</em></span>).</p>
<p></p>
<p></p>
<p>Si considerato invece di utilizzare un operatore locale, come la stessa mediana, applicato perønon su tutta l’immagine ma solo in corrispondenza del disturbo individuato attraverso la misura di anisotropia definita dalla (). La misura effettuata sulla prima componente della <span><em>trasformata di K.-L.</em></span> e la mappa che se ne ottiene in scala di grigio con i valori massimi in corrispondenza dei punti che appartengono a zone dell’immagine ad alta correlazione lungo una direzione. Comunque fra i punti individuati non tutti appartengono ai peli, per cui necessario introdurre un valore di soglia per selezionare quelli aventi una misura sufficientemente elevata.</p>
<p>Ai punti individuati dalla sogliatura possibile quindi applicare un operatore locale, ad esempio un filtro a mediana come in Figura .</p>
<h3 id="inizializzazione-del-contorno-attivo---snake">Inizializzazione del contorno attivo - snake</h3>
<h4 id="motivazione">Motivazione</h4>
<p>Tenendo presente che l’immagine su cui si lavora non perfettamente binaria opportuno, anche in relazione ai problemi di tempi di calcolo dell’evoluzione dello snake, definire un contorno iniziale che sia il pipossibile prossimo a quello reale.</p>
<p>Una possibilitquella di richiedere all’utente di definire alcuni punti e, ad esempio, considerarli come i control points di una curva a B-splines e quindi costruire la curva che li approssima; oppure procedere ad una grossolana pre-segmentazione utilizzando delle tecniche di binarizzazione.</p>
<p>Si considera in particolare quest’ultimo caso che comunque richiede un minimo apporto da parte dell’utente che deve preselezionare sull’immagine originale un’opportuna finestra che contenga il neo.</p>
<h4 id="processo-di-inizializzazione-semiautomatica">Processo di inizializzazione semiautomatica</h4>
<p>A partire dalla componente principale della <span><em>trasformata di K.-L.</em></span>, si effettua una riduzione della risoluzione applicando la () ottenendo una consistente diminuzione dei dati da analizzare e quindi del carico computazionale dei passi successivi, sempre nell’ipotesi di approssimazione a cui si fatto riferimento.</p>
<p>Si procede quindi alla binarizzazione dell’immagine ottenuta con i metodi indicati in (). Occorre tener presente che gli algoritmi indicati, per ragioni di efficienza, considerano come oggetto di indagine l’istogramma del-l’immagine e non l’immagine completa, per cui se l’area occupata dalla macchia circa uguale a quella circostante allora l’istogramma normalizzato risulta abbastanza bimodale approssimando il meglio possibile le ipotesi di validitsu cui si basano gli algoritmi di binarizzazione. Tale condizione puøessere condizionata dalla scelta dell’area da analizzare fatta dall’utente.</p>
<p>Per quanto riguarda i due metodi presentati si preferito quello iterativo in quanto, fissata la tolleranza sull’approssimazione del valore di soglia in modo che non sia eccessivamente restrittiva, si ottengono gli stessi risultati del caso dell’algoritmo di classificazione ma in tempi inferiori.</p>
<p>Il risultato del tipo di Figura in cui si puønotare come non vi sia un unico elemento connesso e con contorni ben definiti, per cui si procede applicando in due passi successivi due operatori morfologici per ottenere una sola regione compatta: con una prima operazione di <span><em>apertura</em></span> si eliminano piccoli disturbi isolati e l’eccessiva frastagliatura del contorno dell’elemento principale (Figura .a); successivamente con un’operazione di <span><em>chiusura</em></span> si ottiene un unico elemento compatto e, adottando un nucleo (o <span><em>structuring element</em></span>) circolare, con i bordi “regolari (<span><em>smooth</em></span>)” (Figura .b).</p>
<p></p>
<p></p>
<p>Il contorno attivo o <span><em>snake</em></span> iniziale ottenuto a partire dal bordo della regione appena individuata ricorrendo ancora ad opportuni operatori morfologici: Sia B l’immagine binaria e K lo <span><em>stucturing element</em></span> scelto fra i due seguenti <br /><span class="math">$$K\,=\,\qmatrix{1 &amp; 1 &amp; 1 \cr
               1 &amp; 1 &amp; 1 \cr
               1 &amp; 1 &amp; 1 \cr} \qquad o \qquad
K\,=\,\qmatrix{0 &amp; 1 &amp; 0 \cr
               1 &amp; 1 &amp; 1 \cr
               0 &amp; 1 &amp; 0 \cr}$$</span><br /> noti come <span class="math">8 − <em>n</em><em>e</em><em>i</em><em>g</em><em>h</em><em>b</em><em>o</em><em>r</em><em>h</em><em>o</em><em>o</em><em>d</em></span> e <span class="math">4 − <em>n</em><em>e</em><em>i</em><em>g</em><em>h</em><em>b</em><em>o</em><em>r</em><em>h</em><em>o</em><em>o</em><em>d</em></span> rispettivamente; allora l’insie-me dei punti o pixel della matrice B che definiscono il contorno <span class="math">Γ </span> definito <br /><span class="math">$$\Gamma\,=\,B\,/\,(B \ominus K)\,=\,B\,\cap\,\overline{(B \ominus K)}\,=\,
B\,\cap\,(\overline{B} \oplus K)$$</span><br /></p>
<p>Una volta individuato il contorno si determina la curva a <span><em>B-spline cubiche uniformi</em></span> che la approssima. Di seguito sono indicati i passi del procedimento: l’insieme <span class="math">Γ </span> definito dai pixel <span class="math"><em>p</em>(<em>r</em>, <em>c</em>)</span>, <span class="math"><em>r</em> ∈ {1, …, <em>R</em>}</span> e <span class="math"><em>c</em> ∈ {1, …, <em>C</em>}</span>, le cui coordinate sono espresse in termini di coppie riga-colonna; per cui le si trasforma nel sistema di riferimento cartesiano <span class="math"><em>X</em> − <em>Y</em></span>; i punti, nel nuovo sistema di riferiemnto, vengono ordinati in senso antiorario <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>; definendo un opportuno criterio di complessitpossibile stabilire il numero di <span><em>spans</em></span> e quindi di <span><em>control points</em></span> (si veda il Capitolo ) con cui descrivere una curva a B-splines che approssimi la curva di cui tali punti si considerano dei campioni. Per determinare i <span><em>control points</em></span> si procede alla soluzione di un sistema di equazioni lineari caratterizzato da un numero di incognite (i <span><em>control points</em></span>) inferiore ai valori noti (i punti campioni della curva) risolvendo un problema ai minimi quadrati; considerando che la curva ottenuta dall’immagine originale ad una risoluzione ridotta occorre effettuare un cambiamento di scala opposto per riportarla nell’immagine originale tenendo presente che va aggiornata la componente di traslazione della trasformazione che lega i due sistemi di riferimento adottati: quello immagine e quello della curva.</p>
<p>La definizione del criterio di complessite il problema della determinazione dei <span><em>control points</em></span> saresposto nei paragrafi successivi.</p>
<h2 id="algoritmo-fase-2">Algoritmo: Fase 2</h2>
<p>La seconda fase caratterizzata dall’evoluzione del contorno definito nella fase precedente fino a raggiungere una condizione di equilibrio. Si considera come modello dello snake la curva a B-splines cubiche uniformi la cui legge di evoluzione nel tempo definita dall’algoritmo di <span><em>Yezzi, Tsai e Willsky</em></span> trattato in (). È proposto inoltre un criterio per misurare la complessitdel contorno della regione da segmentare per ridefinire il numero e la distribuzione dei <span><em>control points</em></span>.</p>
<p>A partire dal vettore dei control points <span class="math">${\bf Q}$</span> e fissato il numero di campioni <span class="math"><em>N</em>(<em>i</em>)</span> per lo span <span class="math"><em>i</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>o</em></span>, con <span class="math"><em>i</em> = 1, …, <em>N</em><sub><em>s</em></sub></span> con <span class="math"><em>N</em><sub><em>s</em></sub></span> numero di spans della curva chiusa pari al numero di punti di controlllo, si puøcalcolare il vettore <span class="math">${\bf X}$</span> dei campioni della curva. Successivamente si calcolano i versori tangenti <span class="math">${\bf X}_s$</span> e normali <span class="math">${\bf X}_n$</span> alla curva nei punti <span class="math">${\bf X}$</span> e la curvatura <span class="math"><em>k</em></span> della curva in <span class="math">${\bf X}$</span>. Calcolo di aree e medie interne ed esterne e dalla () lo stato energetico dello snake. Se si raggiunta la condizione di minima energia, rispetto alle condizioni fissate, allora il processo di segmentazione concluso, altrimenti si continua con l’aggiornamento della curva. Con il passo di aggiornamento si determina il nuovo vettore di punti <span class="math">${\bf Y}$</span> ottenuto da <span class="math">${\bf X}$</span> secondo la legge di evoluzione definita dalla discretizzazione della (). Ogni <span class="math"><em>T</em></span> passi possibile aumentare il numero dei punti di controllo <span class="math"><em>N</em><sub><em>s</em></sub></span> e ridistribuire i campioni <span class="math">${\bf Y}$</span> della curva secondo il criterio di complessitfissato. A partire da <span class="math">${\bf Y}$</span> e <span class="math"><em>N</em><sub><em>s</em></sub></span> (o eventualmente i loro aggiornamenti) si determina il nuovo vettore <span class="math">${\bf Q}$</span> dei punti di controllo che definisce la curva a B-splines che meglio approssima, ai minimi quadrati, la curva i cui campioni sono dati da <span class="math">${\bf Y}$</span>. Si ritorna al passo .</p>
<p>Vediamo ora in dettaglio i singoli passi.</p>
<h3 id="passo-1-calcolo-di-bf-x-bf-x_s-bf-x_n-k">Passo 1: calcolo di <span class="math">${\bf X}$</span>, <span class="math">${\bf X}_s$</span>, <span class="math">${\bf X}_n$</span>, <span class="math"><em>k</em></span></h3>
<p>È possibile esprimere tali vettori in funzione dei punti di controllo definendo opportune matrici <span class="math">${\bf A}$</span>, <span class="math">${\bf A}_s$</span> e <span class="math">${\bf A}_{ss}$</span> (si veda l’Appendice ).</p>
<p>Considerata la curva chiusa <span class="math">Γ </span> descritta per mezzo delle B-splines cubiche e uniformi dalla carta <span class="math">${\bf r}(s,t)$</span> e discretizzandola rispetto alla variabile <span class="math"><em>s</em></span> possibile ottenere il vettore dei campioni =<span><strong>A</strong></span><span><strong>Q</strong></span> I versori <span class="math">${\bf \tau}$</span> tangenti alla curva sono definiti, nel continuo, dalla (<span><strong>r</strong></span>(s,t))= che applicata ai punti di <span class="math">${\bf X}(i)$</span>, <span class="math"><em>i</em> = 1, …, <em>N</em><sub><em>p</em></sub></span> risulta (<span><strong>X</strong></span>(i))= con <sub>s</sub>=<span><strong>A</strong></span><sub>s</sub><span><strong>Q</strong></span>. Considerato che <span class="math">${\bf \tau}$</span> definisce l’orientamento positivo di percorrenza della curva, che qui considerato antiorario, possibile calcolare la normale esterna <span class="math">${\bf n}$</span> non appena si fissi l’orientamento positivo del piano che considerato dal versore <span class="math">${\bf e}_3$</span>; per cui risulta (<span><strong>r</strong></span>(s,t))=<span><strong></strong></span><sub>3</sub>(<span><strong>r</strong></span>)=(<sub>y</sub>,-<sub>x</sub>,0) e che si riduce alla coppia <span class="math">(<em>τ</em><sub><em>y</em></sub>,  − <em>τ</em><sub><em>x</em></sub>)</span>; quindi esprimibile dalla (<span><strong>r</strong></span>(s,t))= Riferito ai campioni della curva vale <sub>n</sub>(i)=(X(i)).</p>
<p>Per quanto riguarda la curvatura si considera la definizione k(<span><strong>r</strong></span>(s,t))= che rappresenta la curvatura con segno della curva <span class="math">${\bf r}(s,t)$</span>; che si semplifica nella k(<span><strong>X</strong></span>(i))= dove <span class="math">${\bf X}_{ss}={\bf A}_{ss}\,{\bf Q}$</span>. È possibile definire anche il vettore curvatura diretto lungo la normale esterna <span class="math">${\bf k}\,=\,k\,{\bf n}$</span>.</p>
<h3 id="passo-2-calcolo-delle-medie-e-aree-interne-ed-esterne-alla-curva">Passo 2: calcolo delle medie e aree interne ed esterne alla curva</h3>
<p>La funzione energia definita da Yezzi et al. <span class="citation" data-cites="Yezzi"></span> e la relativa legge di aggiornamento prevedono il calcolo del vettore delle medie e delle aree delle regioni interna ed esterna rispetto alla curva chiusa.</p>
<p>Considerando che dalla Fase 1 si ottiene una curva iniziale che abbastanza prossima al contorno finale conveniente applicare la versione locale suggerita nello stesso articolo: ovvero la regione interna compresa fra la curva <span class="math">Γ </span> e la curva interna <span class="math">Γ <sup><em>i</em><em>n</em><em>t</em></sup></span> e la regione esterna fra <span class="math">Γ </span> e <span class="math">Γ <sup><em>e</em><em>s</em><em>t</em></sup></span>.</p>
<p>Le due nuove curve possono essere ottenute sfruttando quanto visto a proposito dell’invarianza delle curve a B-splines nei confronti delle omotetie (Figura ).</p>
<p>Sfruttando la versione locale si evita di dover considerare la zona vicine ai bordi dell’immagine maggiormente soggetta ai disturbi dovuti agli effetti di bordo dell’ottica del sensore e ad una illuminazione non uniforme.</p>
<h3 id="passo-3-la-condizione-di-equilibrio">Passo 3: la condizione di equilibrio</h3>
<p>L’evoluzione dello snake termina quando la funzione energia ha raggiunto il punto di minimo ovvero, come punto di estremo, ha gradiente nullo. Fra le due condizioni, teoricamente equivalenti, si scelta la prima in quanto pisemplice da determinare una volta note le due medie; la seconda infatti richiede di verificare che l’incremento fra due istanti successivi trascurabile per ogni campione della curva.</p>
<p>In condizioni ideali la funzione <span class="math">${\cal E}(t)$</span>, che descrive l’andamento dell’energia durante l’evoluzione dello snake, monotona decrescente fino alla condizione di equilibrio, e poi rimane costante, per cui il minimo individuato nel momento in cui vale <span class="math">${\cal E}(t^\ast)={\cal E}(t^\ast +1)$</span> per i due istanti successivi <span class="math"><em>t</em><sup> * </sup></span> e <span class="math"><em>t</em><sup> * </sup> + 1</span>.</p>
<p>Nelle condizioni reali invece ciønon vale a causa delle approssimazioni introdotte e quindi per stabilire il raggiungimento della condizione di equilibrio piŏpportuno valutare l’andamento dell’energia negli ultimi <span class="math"><em>T</em><sub><em>e</em></sub></span> passi di calcolo; in particolare si considera la funzione (t)= <sub>t-T<sub>e</sub>+1</sub><sup>t</sup>|<span>E</span>(t)-<span>E</span>(t-1)|</p>
<p>che rappresenta la media dei valori assoluti delle variazioni dell’energia totale degli ultimi <span class="math"><em>T</em><sub><em>e</em></sub></span> passi di calcolo relativa all’energia all’istante <span class="math"><em>t</em></span>.</p>
<p>Si considera <span class="math">${\cal E}(t)$</span> “costante” quando <span class="math"><em>ε</em>(<em>t</em>)</span> inferiore ad un valore prefissato che essendo espresso in termini relativi indipendente dal valore di <span class="math">${\cal E}(t)$</span>.</p>
<h3 id="passo-4-aggiornamento-della-curva-in-base-alla-legge-di-evoluzione">Passo 4: aggiornamento della curva in base alla legge di evoluzione</h3>
<p>Come detto si considera il modello di <span><em>snake</em></span> la cui legge di evoluzione data dalla () =<sub>j=1</sub><sup>N</sup>(m<sub>j</sub><sup>int</sup>-m<sub>j</sub><sup>est</sup>) . Per poterla applicare necessario discretizzarla sia nella variabile spaziale sia in quella temporale; per quanto riguarda la prima si procede come sopra considerando i campioni della curva dati da <span class="math">${\bf r}_i$</span>, mentre per la variabile temporale si approssima la derivata con il rapporto incrementale (un’approssimazione del primo ordine): = da cui si ottiene (t + t)=(t)+t ovvero (i)=<span><strong>X</strong></span>(i,t + 1)=<span><strong>X</strong></span>(i,t)+g(k<sub>i</sub>)(<span><strong>X</strong></span>(i))</p>
<p>Le coordinate dei campioni <span class="math">${\bf X}$</span> sono definite in <span class="math">$[0,C]\times[0,R]\subset\M(R)^2$</span>, mentre le primitive <span class="math"><em>P</em><sub><em>j</em></sub></span> sono definite per i pixels di coordinate <span class="math">(<em>r</em>, <em>c</em>)</span> appartenenti a <span class="math">$\{1,R\}\times\{1,C\}\subset\M(N)^2$</span>, con <span class="math"><em>R</em></span> e <span class="math"><em>C</em></span> numero di righe e di colonne, quindi necessario poter stabilire l’intensitdella primitiva da associare al campione della curva. Il punto <span class="math"><em>X</em>(<em>i</em>) = (<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)</span> puøessere associato al pixel di riga <span class="math"><em>r</em> = ⌈<em>y</em><sub><em>i</em></sub>⌉</span> e colonna <span class="math"><em>c</em> = ⌈<em>x</em><sub><em>i</em></sub>⌉</span>( ), per cui l’intensitdella primitiva <span class="math"><em>P</em>(<em>r</em>, <em>c</em>)</span>.</p>
<p>Per tener conto che il punto non necessariamente al centro del pixel e del fatto che il valore del pixel stesso potrebbe essere affetto da rumore opportuno considerare <span class="math"><em>P</em></span> su una finestra di pixel nell’intorno di quello fissato; ad esempio considerando la media pesata o la mediana dei valori dei pixel della finestra.</p>
<h4 id="la-funzione-guadagno-gk">La funzione guadagno g(k)</h4>
<p>Si noti che l’“incremento temporale” <span class="math">Δ <em>t</em></span> stato conglobato nella funzione <span class="math"><em>g</em>(<em>k</em>)</span> che definisce un opportuno guadagno che dipende dalla curvatura nel punto <span class="math"><em>i</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>o</em></span> <span class="math"><em>X</em>(<em>i</em>)</span>. La dipendenza del guadagno dalla curvatura permette di modulare l’incremento in funzione delle caratteristiche locali della curva riducendo il peso delle misure effettuate in tratti ad elevata curvatura che potrebbero determinare la formazione di cappi.</p>
<p>Tenendo presente che <span class="math"><em>k</em></span> la curvatura con segno, la funzione guadagno deve essere pari, per cui una possibile scelta data dalla gaussiana g(k)=g<sub>0</sub>(- k<sup>2</sup>) dove <span class="math"><em>g</em><sub>0</sub></span> il guadagno massimo e il fattore <span class="math"><em>α</em></span> definisce la forma del filtro.</p>
<p>La scelta di <span class="math"><em>g</em><sub>0</sub></span> va fatta tenendo conto che se da un lato puøaumentare la velocità dello <span><em>snake</em></span>, ovvero ridurre i tempi di convergenza, dall’altro puørenderlo instabile o fare in modo che l’evoluzione si arresti su minimi relativi non corrispondenti al bordo dell’oggetto che si vorrebbe identificare.</p>
<h4 id="gli-insiemi-di-livello">Gli insiemi di livello</h4>
<p>Nell’articolo <span class="citation" data-cites="Yezzi"></span> gli autori utilizzano gli <span><em>insiemi di livello</em></span> (<span><em>level set</em></span>) <span class="citation" data-cites="Malladi"></span> come soluzione per l’implementazione della legge di evoluzione; tale metodo permette inoltre di realizzare in modo efficiente e automatico le operazioni topologiche di divisione e fusione di <span><em>snakes</em></span> per poter individuare piŏggetti presenti nell’immagine a partire da una sola curva oppure da picurve (<span><em>semi</em></span>) disseminate sull’immagine.</p>
<p>La possibilitdi realizzare tali trasformazioni non presente negli altri modelli di snake se non con l’aggiunta di procedure supplementari (come nel caso proposto in <span class="citation" data-cites="Terzopoulos"></span>).</p>
<p>Nel nostro caso comunque si scelto di adottare la legge espressa nella sua forma originale e procedere a semplici discretizzazioni.</p>
<h3 id="passo-5-il-criterio-di-complessitdella-curva">Passo 5: il criterio di complessitdella curva</h3>
<p>Nella fase di inizializzazione dello <span><em>snake</em></span> vengono individuati un certo numero di control points che si ritiene sufficiente a descrivere il contorno dell’oggetto individuato dalla binarizzazione, numero che potrebbe non essere comunque sufficiente in relazione alla complessiteffettiva dell’elemento da segmentare.</p>
<p>Durante l’evoluzione inoltre si puøtrovare che un certo numero di campioni maggiormente concentrato in un tratto della curva non eccessivamente complesso, e con essi anche un maggior numero di control points, con conseguenze negative per la regolaritdella curva stessa (si veda ). Si deciso perciødi ricostruire una nuova sequenza di campioni da ridistribuire ad un nuovo insieme di punti di controllo di dimensioni diverse dal precedente; in questo modo si scorrela l’evoluzione della curva dai passi precedenti accelerando la convergenza al risultato finale.</p>
<h4 id="ricampionamento-della-curva">Ricampionamento della curva</h4>
<p>Dato il vettore di punti <span class="math">${\bf Y}$</span> ottenuto nel passo precedente, si considera la poligonale i cui vertici sono proprio gli elementi di <span class="math">${\bf Y}$</span> e a questa si sovrappone un particolare reticolo e si determinano le intersezioni <span class="math">${\bf \Upsilon}(i)$</span> fra la poligonale e il reticolo: quest’ultime costituiscono i nuovi campioni della curva (Figura ).</p>
<p></p>
<p>Il reticolo introdotto rappresenta un esempio di <span><em>reticolazione simpliciale</em></span> o <span><em>triangolazione</em></span> del piano che risulta scomposto nella somma di <span><em>simplessi</em></span> topologici, che nel caso in esame sono i singoli triangoli , che offre i seguenti vantaggi:</p>
<p>una rappresentazione univoca della curva; variando la densitdel reticolo possibile controllare il grado di approssimazione del contorno e di conseguenza anche la velocitdi convergenza al risultato finale.</p>
<p>Si osserva che la scelta della riparametrizzazione con l’uso della triangolazione simpliciale utilizzata in <span class="citation" data-cites="Terzopoulos"></span> per implementare le trasformazioni topologiche.</p>
<h4 id="definizione-del-criterio-di-complessit">Definizione del criterio di complessit</h4>
<p>I nuovi campioni vengono successivamente distribuiti ai nuovi spans in modo che la complessitdi ciascun span sia entro un limite massimo prefissato <span class="math">${\cal M}$</span> interpretabile come la “massa” totale dello span.</p>
<p>Per ciascun punto <span class="math">${\bf \Upsilon}(i)$</span> si considerano i due vettori <span class="math">${\bf u}(i)$</span> e <span class="math">${\bf v}(i)$</span> <br /><span class="math">$${\bf u}(i)=\frac{{\bf \Upsilon}(i-1)-{\bf \Upsilon}(i)}{L} \qquad
{\bf v}(i)=\frac{{\bf \Upsilon}(i+1)-{\bf \Upsilon}(i)}{L},$$</span><br /> normalizzati rispetto la lunghezza <span class="math"><em>L</em></span> della poligonale di vertici <span class="math">${\bf \Upsilon}(i)$</span>, e le due funzioni <br /><span class="math">$$d(i)\,=\,d({\bf u}(i),{\bf v}(i))\,=\,\|{\bf u}(i)\|+\|{\bf v}(i)\|$$</span><br /> <br /><span class="math">$$c(i)\,=\,c({\bf u}(i),{\bf v}(i))\,=\,\|{\bf u}(i)+{\bf v}(i)\|$$</span><br /> che descrivono i due contributi della complessitdella “curva” nel punto: il primo tiene conto della distanza fra i due vertici precedente e successivo, in senso antiorario, mentre il secondo del grado di allineamento fra i tre punti (una sorta di curvatura). Entrambi sono normalizzati rispetto alla lunghezza (perimetro) della poligonale in modo da rendere il procedimento indipendente dalle dimensioni.</p>
<p>La complessittotale definita dalla combinazione dei due termini secondo i pesi <span class="math"><em>w</em><sub><em>d</em></sub></span> e <span class="math"><em>w</em><sub><em>c</em></sub></span>: (i)=w<sub>d</sub>d(i)+w<sub>c</sub>c(i)</p>
<p>Nell’applicazione considerata, si sono ottenuti migliori risultati con <span class="math"><em>w</em><sub><em>d</em></sub> &gt; <em>w</em><sub><em>c</em></sub></span>.</p>
<p>Quindi nota la “densit” <span class="math"><em>μ</em>(<em>i</em>)</span> si suddivide il vettore <span class="math"><em>Υ</em></span> in <span><em>spans</em></span> aventi “massa” minore o al piŭguale a <span class="math">${\cal M}$</span>; in tal modo si determina la nuova lunghezza del vettore dei control points <span class="math"><em>N</em><sub><em>s</em></sub><sup> ′</sup></span> per i quali vanno aggiornate le matrici <span class="math">${\bf A}$</span>, <span class="math">${\bf A}_s$</span> e <span class="math">${\bf A}_{ss}$</span> che saranno utilizzate all’inizio del successivo passo di evoluzione dello snake.</p>
<p></p>
<p>In Figura .a mostra è rappresentato l’andamento dell’energia dei campioni della funzione <span class="math">$(d \Gamma / dt)({\bf X}(i))$</span>, ovvero la norma <span class="math"><em>L</em><sub>2</sub></span> dello stesso vettore, che si puøpensare indicativa delle “forze” deformanti che agiscono sullo <span><em>snake</em></span>; la .b mostra invece il modulo dell’energia dello snake valutata secondo la ().</p>
<p>Man mano che si procede verso lo stato di equilibrio finale si ha mediamente una diminuzione della prima in quanto si sempre pivicini all’o-biettivo finale (come se agisse una forza elastica) mentre la seconda aumenta, ovvero l’energia con segno del sistema diminuisce, coerentemente con le ipotesi fatte sullo stato di equilibrio a minima energia potenziale.</p>
<h3 id="passo-6-la-rappresentazione-a-b-splines-della-curva-aggiornata">Passo 6: la rappresentazione a B-splines della curva aggiornata</h3>
<p>Ad ogni ciclo sia che si abbia una ridistribuzione dei punti <span class="math">${\bf \Upsilon}$</span> sia che si considerino direttamente i punti ottenuti dal processo di aggiornamento <span class="math">$\bf Y$</span>, si procede alla determinazione della rappresentazione della curva a <span><em>B-splines cubiche uniformi</em></span> che approssima i campioni ottenuti calcolando il nuovo vettore di control points <span class="math">$\hat{\bf Q}$</span>.</p>
<p>A partire dall’espressione definita precedentemente <span class="math">${\bf X}={\bf A}\,{\bf Q}$</span>, che lega i control points ai campioni della curva, possibile ricavare una soluzione al problema inverso ovvero ottenere i control points dai campioni <span class="math">${\bf \Upsilon}$</span>.</p>
<p>Per il sistema di equazioni lineari <span><strong>Q</strong></span>=<span><strong></strong></span>, dove il numero di vincoli (equazioni) superiore al numero di incognite (<span class="math">${\bf Q}$</span>), si considera il problema in termini di approssimazione ai minimi quadrati, ovvero si considera come soluzione il vettore <span class="math">$\hat{\bf Q}$</span> per cui minima la norma <span class="math">$\|\,{\bf \Upsilon}\,-\,{\bf A}\,\hat{\bf Q}\|$</span>.</p>
<p>La soluzione unica ed data da =<span><strong>A</strong></span><sup></sup><span><strong></strong></span> dove <span class="math">${\bf A}^{\dagger}=({\bf A}^{T}{\bf A})^{-1}){\bf A}^{T}$</span> la <span><em>pseudo-inversa sinistra</em></span> di <span class="math">${\bf A}$</span>.</p>
<h2 id="risultati">Risultati</h2>
<p>Nelle Figure , e sono visualizzati alcuni esempi di risultati dell’ap-plicazione dell’algoritmo di segmentazione sviluppato.</p>
<p>Dalle Figure e si puønotare che l’algoritmo abbastanza insensibile alla condizione iniziale fissata per il contorno attivo, in funzione comunque della qualitdell’immagine elaborata: nel primo caso infatti vi sono dei disturbi dovuti a fenomeni di riflessione in prossimitdei bordi. Nel secondo caso invece le due soluzioni sono abbastanza simili, la differenza tra le due inizializzazioni soprattutto in relazione al tempo di calcolo necessario per raggiungere l’equilibrio finale.</p>
<p>In Figura evidenziato il problema della presenza dei peli in prossimitdei bordi e il miglioramento del risultato se si fa precedere una fase di preelaborazione con un operatore locale anisotropo basato sulla misura di anisotropia definita dalla ().</p>
<p></p>
<p></p>
<p></p>
<p></p>
<h1 id="conclusioni">Conclusioni</h1>
<p>In questa tesi proposto un algoritmo si segmentazione per l’individuazione dei contorni di macchie cutanee il cui nucleo costituito dal metodo di segmentazione basato su un interessante modello di contorno attivo o <span><em>snake</em></span> proposto da Yezzi et al. in <span class="citation" data-cites="Yezzi"></span>. Esso infatti combina i vantaggi dei due approcci con cui vengono affrontati i problemi di segmentazione: quello basato sulla proprietdi omogeneitdei segmenti e quello che realizza la segmentazione individuando i bordi che separano i segmenti.</p>
<p>Per ottenere inoltre una rappresentazione compatta dello stesso contorno, in vista delle successive misure, si scelta la sua rappresentazione a B-splines cubiche uniformi. Visto perøche la forma dell’oggetto da segmentare non nota a priori vi la necessitdi definire un metodo per permettere allo snake di adattarsi alla diversa complessitdella macchia da individuare. Si perciøconsiderato un metodo che sfrutta la riparametrizzazione della curva a partire dai campioni ottenuti dall’intersezione con un reticolo, che la scomposizione simpliciale (o triangolazione) del piano immagine, e la successiva ripartizione di tali punti fra i nuovi <span><em>control points</em></span>, in funzione di un criterio di complessitche tiene conto della distanza e del grado di allineamento, o “curvatura”, fra i campioni.</p>
<p>Dai test effettuati si visto che l’algoritmo poco sensibile all’inizia-lizzazione del contorno attivo, comunque per ridurre i tempi di calcolo opportuno che la curva iniziale sia prossima al bordo dell’oggetto da segmentare. Per questo si definita una procedura di inizializzazione basata sul contorno della regione compatta ottenuta dalla binarizzazione, e successiva elaborazione morfologica, della componente principale della <span><em>trasformata di Karhunen-Loève</em></span> dell’immagine originale.</p>
<p>In relazione ai tempi di esecuzione si puødire che il punto critico dato dal calcolo delle medie interne ed esterne alla curva, quindi opportuno considerare con attenzione una possibile approssimazione della funzione intensitdelle primitive.</p>
<p>È stato definito inoltre un operatore locale basato su una particolare misura di anisotropia per ridurre l’effetto di disturbo dei peli, non sempre trascurabile nel momento in cui tali elementi si trovano in prossimitdel bordo e quindi possono influenzare la dinamica dello <span><em>snake</em></span>.</p>
<p>L’algoritmo stato sviluppato per la segmentazione di macchie cutanee, ma come strutturato e per la natura del modello di snake potenzialmente applicabile ad altri oggetti non appena siano caratterizzabili con un opportuno vettore di primitive (<span><em>features</em></span>).</p>
<h2 id="matrice-di-omotetia">Matrice di omotetia</h2>
<p>Dato il vettore dei <span><em>control points</em></span> <span class="math">${\bf X}=[{\bf x}_i]$</span> che descrivono la curva, e il centroide <span class="math">${\bf c}$</span> definito da =<sub>i=0</sub><sup>m-1</sup><span><strong>x</strong></span><sub>i</sub>. si considerino <span class="math">${\bf z}_i={\bf x}_i-{\bf c}$</span> i raggi vettore uscenti da <span class="math">${\bf c}$</span> verso gli <span class="math">${\bf x}_i$</span>.</p>
<p>Applicando l’omotetia di fattore <span class="math"><em>γ</em></span> i nuovi raggi vettore <span class="math">$\hat{\bf z}_i$</span> risultano <sub>i</sub>=<span><strong>z</strong></span><sub>i</sub> per cui i nuovi control points si ottengono da <sub>i</sub> &amp; = &amp; <sub>i</sub>+<span><strong>c</strong></span> =(<span><strong>x</strong></span><sub>i</sub>-<span><strong>c</strong></span>)+<span><strong>c</strong></span>=<br />&amp; = &amp; <span><strong>x</strong></span><sub>i</sub>+(1-)<span><strong>c</strong></span> =<span><strong>x</strong></span><sub>i</sub>+<span><strong>1</strong></span><sub>1 m</sub><span><strong>X</strong></span> Quindi il nuovo vettore di <span><em>control points</em></span> risulta &amp; = &amp; <span><strong>X</strong></span>+ <span><strong>X</strong></span><br />&amp; &amp;<br />&amp; = &amp; <span><strong>X</strong></span>= <span><strong>R</strong></span>()<span><strong>X</strong></span> con <span class="math">${\bf I}_m$</span> matrice identica di ordine <span class="math"><em>m</em></span> e <span class="math">${\bf 1}_m$</span> matrice <span class="math"><em>m</em> × <em>m</em></span> di “<span class="math">1</span>”.</p>
<p>Esprimendo la rappresentazione a B-spline della curva nella forma (u)=<sub>i=0</sub><sup>m-1</sup>B<sub>i</sub>(u)<span><strong>x</strong></span><sub>i</sub>=<span><strong>B</strong></span>(u)<span><strong>X</strong></span> dove <span class="math">${\bf B}(u)$</span> e <span class="math">${\bf X}$</span> sono rispettivamente i vettori delle basi <span class="math"><em>B</em><sub><em>i</em></sub></span> e dei control points, la curva trasformata risulta (u)=<span><strong>B</strong></span>(u)<span><strong>R</strong></span>()<span><strong>X</strong></span>.</p>
<h2 id="matrici-per-la-rappresentate-a-b-splines-di-curve">Matrici per la rappresentate a B-splines di curve</h2>
<p>A partire dalla (), possibile rappresentare in termini di prodotto di matrici la carta a B-splines che descrive lo span <span class="math"><em>i</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>o</em></span>, <span class="math"><em>i</em> = 0, …, <em>N</em><sub><em>s</em></sub> − 1</span>, della curva <span class="math">Γ </span> <sub>i</sub>(s)=<span><strong>s</strong></span><sup>T</sup><span><strong>M</strong></span><span><strong>Q</strong></span><sub>i</sub> dove <span class="math">${\bf s}=[s^3,s^2,s,1]^T$</span>, <span class="math"><em>s</em> ∈ [0, 1]</span>, <span class="math"><em>M</em></span> la matrice <span class="math">(4 × 4)</span> che descrive la forma della B-spline <span class="math"><em>B</em></span> di riferimento, e <span class="math">${\bf Q}_i$</span> la quaterna di <span><em>control points</em></span> che definiscono come si combinano i quattro tratti di cubica (Capitolo ).</p>
<p>Si proceda quindi alla discretizzazione di <span class="math"><em>s</em></span> a cui corrispondono i campioni <span class="math">${\bf r}_i(s_j)$</span> per <span class="math"><em>s</em><sub><em>j</em></sub> = <em>j</em> / <em>N</em><sub><em>c</em></sub></span> con <span class="math"><em>j</em> = 0, …, <em>N</em><sub><em>c</em></sub> − 1</span> e <span class="math"><em>N</em><sub><em>c</em></sub></span> il numero di campioni per span; si ottiene quindi, per il singolo campione, <br /><span class="math">$$X_i(j)\,=\,\frac{1}{6}\,{\bf s}_j^T\,{\bf M}\,{\bf Q}_i$$</span><br /> e incolonnando per tutti i campioni dello span <sub>i</sub>=<sub>i</sub><span><strong>Q</strong></span><sub>i</sub> <br /><span class="math">$$\hat{\bf A}_i=\frac{1}{6}\,\qmatrix{{\bf s}_0^T \cr
                                         \vdots \cr 
                                    {\bf s}_j^T \cr
                                         \vdots \cr
                                    {\bf s}_{N_c-1}^T \cr}\,{\bf M}\,=\,
              {\bf S}_i\,{\bf M} \qquad (N_c \times 4)$$</span><br /></p>
<p>Un’ulteriore passo nella semplificazione dell’espressione fatto considerando <span class="math">${\bf Q}_i={\bf G}_i{\bf Q}$</span>, con <span class="math">${\bf Q}$</span> vettore completo dei control points; quindi riassumendo si ottiene == =<span><strong>A</strong></span><span><strong>Q</strong></span> con <span class="math">${\bf X}\,(N_s\,N_c \times 2)$</span>, <span class="math">${\bf A}\,(N_s\,N_c \times N_s)$</span> e <span class="math">${\bf Q}\,(N_s \times 2)$</span>.</p>
<p>Le matrici <span class="math">${\bf G}_i\,(4 \times N_s)$</span> legano lo span <span class="math"><em>i</em> − <em>e</em><em>s</em><em>i</em><em>m</em><em>o</em></span> con i relativi <span><em>control points</em></span> in <span class="math">${\bf Q}$</span>. Si noti che rispetto a quanto detto nel Capitolo possibile rappresentare un circuito senza aggiungere i primi tre <span><em>control points</em></span> alla fine del vettore ma direttamente attraverso la matrice <span class="math">${\bf A}$</span>.</p>
<p>(5)</p>
<p>Per chiarire la struttura delle <span class="math">${\bf G}_i$</span> si considera l’esempio in cui <span class="math"><em>N</em><sub><em>s</em></sub> = 5</span>: <br /><span class="math">$${\bf G}_0\,=\,\qmatrix{ 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \cr
                        0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \cr
                        0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \cr
                        0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \cr}, \quad
{\bf G}_1\,=\,\qmatrix{ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \cr
                        0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \cr
                        0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \cr
                        0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \cr}, \quad \dots$$</span><br /> Come si puønotare la seconda matrice ottenuta traslando verso destra la diagonale di <span class="math">1</span>, ovvero moltiplicando la matrice <span class="math">${\bf G}_0$</span> per una matrice <span class="math">${\bf K}$</span> quadrata <span class="math">(<em>N</em><sub><em>s</em></sub> × <em>N</em><sub><em>s</em></sub>)</span> <br /><span class="math">$${\bf K}\,=\,\qmatrix{ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \cr
                      0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \cr
                      0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \cr
                      0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \cr
                      1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \cr}$$</span><br /> Il risultato puøessere esteso anche alle altre matrici <span class="math">${\bf G}_i$</span> per cui vale <br /><span class="math">$${\bf G}_{i+1}\,=\,{\bf G}_i\,{\bf K} \qquad i=0,\dots,N_s-2$$</span><br /> e dove <span class="math">${\bf G}_0$</span> ha una struttura nota <br /><span class="math">$${\bf G}_0\,=\,\qmatrix{{\bf I}_4 &amp; | &amp;{\bf O}_{4,N_s-4} \cr}.$$</span><br /></p>
<p>(5)</p>
<p>Per ottenere le matrici <span class="math">${\bf A}_s$</span> e <span class="math">${\bf A}_{ss}$</span> sufficiente considerare che derivando rispetto a <span class="math"><em>s</em></span> la <span class="math">${\bf r}_i(s)$</span> si ottiene <sub>i<sub>s</sub></sub>(s)=<span><strong>s</strong></span><sub>s</sub><sup>T</sup><span><strong>M</strong></span><span><strong>Q</strong></span><sub>i</sub> con <span class="math">${\bf s}_s=[3s^3,2s,1,0]$</span>; per cui sufficiente modificare le singole <span class="math">${\bf S}_i$</span>.</p>
<p>Analogamente per la derivata seconda rispetto <span class="math"><em>s</em></span>.</p>
<p>Data <span class="math">${\bf A}$</span>, matrice quadrata <span class="math">(<em>n</em> × <em>n</em>)</span>, <span class="math">${\bf x}$</span> e <span class="math">${\bf y}$</span> due vettori colonna <span class="math"><em>n</em> − <em>d</em><em>i</em><em>m</em></span> allora vale <span><strong>x</strong></span>-<span><strong>A</strong></span><span><strong>y</strong></span>= <span><strong>x</strong></span><span><strong>y</strong></span>.</p>
<p>Dalla definizione di prodotto scalare <span class="math">( ⋅ )</span> <br /><span class="math">$${\bf A}\,{\bf x}\cdot{\bf y}\,=\,({\bf A}\,{\bf x})^T\,{\bf y}$$</span><br /> e dalla commutativitsi ha che <br /><span class="math">$${\bf A}\,{\bf x}\cdot{\bf y}\,-\,{\bf A}\,{\bf y}\cdot{\bf x}\,=\,
 {\bf x}^T\,{\bf A}^T\,{\bf y}\,-\,{\bf x}^T\,{\bf A}\,{\bf y}\,=\,$$</span><br /> <br /><span class="math">$${\bf x}^T\,\Big[{\bf A}^T-{\bf A}\Big]\,{\bf y}\,=\,
 {\bf x}\cdot\Big[{\bf A}^T-{\bf A}\Big]\,{\bf y}.$$</span><br /></p>
<p>Sia h(t)=<sub>R(t)</sub>f(x,y)dxdy con <span class="math"><em>R</em>(<em>t</em>)</span> la regione racchiusa dalla curva chiusa <span class="math">Γ (<em>t</em>)</span> e <span class="math">$f:\M(R)^2 \longrightarrow \M(R)$</span> una funzione continua.</p>
<p>Definita la funzione vettoriale <span><strong>g</strong></span>(x,y) con g<sub>1</sub>(x,y)=-<sub>0</sub><sup>y</sup>f(x,)dg<sub>2</sub>(x,y)=<sub>0</sub><sup>x</sup>f(,y)dpossibile scrivere h(t)=<sub>R(t)</sub> dxdy</p>
<p>Dal <span><em>teorema di Stokes</em></span>, che nel caso in esame di curve piane si riduce alle <span><em>formule di Green</em></span>, si ottiene h(t)=<sub>(t)</sub><span><strong>g</strong></span>dl. Considerando che <span class="math">Γ (<em>t</em>)</span> rappresentata dalla carta <span class="math">${\bf r}(s,t)=[x(s,t),y(s,t)]$</span>, con <span class="math"><em>s</em> ∈ [0, 1]</span>, e che il vettore tangente alla curva esprimibile in funzione della parametrizzazione (s,t)= risulta h(t)=<sub>0</sub><sup>1</sup><span><strong>g</strong></span> <span>(s,t)</span>ds= <sub>0</sub><sup>1</sup><span><strong>g</strong></span><sub>s</sub>(s,t)</p>
<p>Calcolare <span class="math">∇<em>h</em></span> lungo la curva regolare <span class="math">Γ </span> equivalente a massimizzare la variazione <span class="math"><em>h</em><sup> ′</sup>(<em>t</em>)</span> h<sup></sup>(t)=<sub>0</sub><sup>1</sup>ds.</p>
<p>Integrando per parti rispetto a <span class="math"><em>s</em></span> il secondo termine dell’integranda risulta <sub>0</sub><sup>1</sup><span><strong>g</strong></span><sub>s,t</sub>(s,t) &amp; = &amp; <span><strong>g</strong></span><sub>ts=0</sub><sup>s=1</sup> -<sub>0</sub><sup>1</sup><span><strong>g</strong></span><sub>st</sub>(s,t)ds=<br />&amp; = &amp; -<sub>0</sub><sup>1</sup><span><strong>g</strong></span><sub>st</sub>(s,t)ds in quanto il primo addendo nullo dato che la curva chiusa e quindi <span class="math">${\bf r}(0)={\bf r}(1)$</span> per cui <span class="math">${\bf g}({\bf r}(0))={\bf g}({\bf r}(1))$</span> e cospure <span class="math">${\bf r}_t(0)={\bf r}_t(1)$</span>.</p>
<p>Considerando inoltre che il differenziale di funzioni composte <sub>s</sub> &amp; = &amp; <span><strong>g</strong></span><sub>s</sub>(<span><strong>r</strong></span>(s,t))=J<span><strong>g</strong></span>(x,y)<span><strong>r</strong></span><sub>s</sub>(s,t)<br />&amp; &amp;<br /><span><strong>g</strong></span><sub>t</sub> &amp; = &amp; <span><strong>g</strong></span><sub>t</sub>(<span><strong>r</strong></span>(s,t))=J<span><strong>g</strong></span>(x,y)<span><strong>r</strong></span><sub>t</sub>(s,t), con <br /><span class="math">$$J{\bf g}(x,y)\,=\,
\smatrix{2}{{\ds\frac{\partial g_1}{\partial x}} &amp; {\ds\frac{\partial g_1}{\partial y}} \cr
        {\ds\frac{\partial g_2}{\partial x}} &amp; {\ds\frac{\partial g_2}{\partial y}}}(x,y)\,=\,
\smatrix{2}{ 0 &amp; -f \cr
             f &amp;  0 }(x,y)\,=\,$$</span><br /> =f(x,y), assieme alle precedenti si ottiene l’espressione per <span class="math"><em>h</em><sup> ′</sup>(<em>t</em>)</span> h<sup></sup>(t)=<sub>0</sub><sup>1</sup>ds.</p>
<p>Applicando il Lemma con <span class="math">${\bf x}={\bf r}_t$</span>, <span class="math">${\bf A}=J{\bf g}$</span> e <span class="math">${\bf y}={\bf r}_s$</span> h<sup></sup>(t)=<sub>0</sub><sup>1</sup> ds</p>
<p>Dalla () si vede che lo <span><em>Jacobiano</em></span> antisimmetrico, per cui lo pure la differenza <span class="math">$(J{\bf g})^T-J{\bf g}$</span> che infatti vale <br /><span class="math">$$2\,f(x,y)\,\smatrix{2}{  0 &amp; 1 \cr
                        -1 &amp; 0 },$$</span><br /> dato che per la proprietdi antisimmetria <span class="math">$(J{\bf g})^T=-J{\bf g}$</span>.</p>
<p>Sostituendo nella () h<sup></sup>(t)= <sub>0</sub><sup>1</sup>ds</p>
<p>Nell’ipotesi per cui l’orientamento positivo di percorrenza di <span class="math">Γ </span> sia quello antiorario e che l’orientamento positivo della regione <span class="math"><em>R</em></span> sia <span class="math">${\bf e}_3$</span> allora sussiste la relazione fra il versore tangente e quello normale alla curva <br /><span class="math">$${\bf n}\,=\,\smatrix{2}{  0 &amp; 1 \cr
                         -1 &amp; 0 }\,{\bf \tau};$$</span><br /> considerando inoltre l’espressione () si ha <sub>s</sub><span><strong>n</strong></span>=<span><strong>r</strong></span><sub>s</sub>.</p>
<p>Quest’ultimo uno dei termini del prodotto scalare dell’integranda in () e quindi h<sup></sup>(t)= <sub>0</sub><sup>1</sup><sub>s</sub>ds= <sub>(t)</sub><span><strong>r</strong></span><sub>t</sub>f<span><strong>n</strong></span>dl per cui la direzione lungo la quale deformare la curva <span class="math">Γ </span> in modo che sia massima <span class="math"><em>h</em><sup> ′</sup></span> data dal flusso <br /><span class="math">$${\bf r}_t\,=\,f\,{\bf n}.$$</span><br /></p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p><span class="math">1 / (1 + exp( − <em>k</em> <em>x</em>))</span><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Oppure si parte da una descrizione del contorno in pixel gidefinita in senso antiorario utilizzando ad esempio una rappresentazione tipo <span><em>chain code</em></span>.</p>
<p>Il senso antiorario considerato il verso di percorrenza positivo della curva; risulta determinante nella relazione fra il versore tangente alla curva e la normale esterna.<a href="#fnref2">↩</a></p></li>
</ol>
</section>
</body>
</html>
